<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.13" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.49" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/E-utilities_zh-CN/E-utilities_zh-CN/07-Entrez%20Direct%20Examples_zh-CN.html"><meta property="og:site_name" content="E-utilities 汉化文档"><meta property="og:title" content="Entrez Direct 示例"><meta property="og:description" content="Entrez Direct 示例 Jonathan Kans, PhD. 作者信息和隶属关系 创建时间：2013 年 4 月 23 日；最后更新：2024 年 4 月 12 日。 预计阅读时间：21 分钟 一些早期的 EDirect 示例需要使用 shell 脚本进行后处理： 或 awk 命令： 以增加基于 0 的序列坐标，以便检索正确的区域： 这导致..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-07-10T07:54:22.000Z"><meta property="article:author" content="WhyLIM"><meta property="article:modified_time" content="2024-07-10T07:54:22.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Entrez Direct 示例","image":[""],"dateModified":"2024-07-10T07:54:22.000Z","author":[{"@type":"Person","name":"WhyLIM","url":"https://github.com/WhyLIM"}]}</script><title>Entrez Direct 示例 | E-utilities 汉化文档</title><meta name="description" content="Entrez Direct 示例 Jonathan Kans, PhD. 作者信息和隶属关系 创建时间：2013 年 4 月 23 日；最后更新：2024 年 4 月 12 日。 预计阅读时间：21 分钟 一些早期的 EDirect 示例需要使用 shell 脚本进行后处理： 或 awk 命令： 以增加基于 0 的序列坐标，以便检索正确的区域： 这导致...">
    <link rel="preload" href="/E-utilities_zh-CN/assets/style-DZq-hVHB.css" as="style"><link rel="stylesheet" href="/E-utilities_zh-CN/assets/style-DZq-hVHB.css">
    <link rel="modulepreload" href="/E-utilities_zh-CN/assets/app-BSJRkk3t.js"><link rel="modulepreload" href="/E-utilities_zh-CN/assets/07-Entrez Direct Examples_zh-CN.html-DtxX__VL.js"><link rel="modulepreload" href="/E-utilities_zh-CN/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/E-utilities_zh-CN/assets/index.html-CH-nT_7U.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/portfolio.html-vRjQ5F7z.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/01-E-utilities Quick Start_EN.html-BfcPQfmP.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/02-A General Introduction to the E-utilities_EN.html-_Z553IWL.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/03-Sample Applications of the E-utilities_EN.html-CKxCg0ca.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/04-The E-utilities In-Depth_EN.html-BKDjPwV8.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/05-The E-utility Web Service (SOAP)_EN.html-D-zLwPXp.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/06-E-utilities on the Unix Command Line_EN.html-DrB6j5la.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/07-Entrez Direct Examples_EN.html-D1jebrOq.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/01-E-utilities Quick Start_zh-CN.html-Dl3UNGn-.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/02-A General Introduction to the E-utilities_zh-CN.html-DDSL21O6.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/03-Sample Applications of the E-utilities_zh-CN.html-C9ECTgQe.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/04-The E-utilities In-Depth_zh-CN.html-ChFmRDfY.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/05-The E-utility Web Service (SOAP)_zh-CN.html-D7DGMzKA.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/06-E-utilities on the Unix Command Line_zh-CN.html-BWW9U-Vc.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/404.html-B0pRHFRh.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/index.html-D7fj8AY5.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/index.html-Ceq-lghF.js" as="script"><link rel="prefetch" href="/E-utilities_zh-CN/assets/photoswipe.esm-GXRgw7eJ.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/E-utilities_zh-CN/"><img class="vp-nav-logo" src="https://theme-hope-assets.vuejs.press/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">E-utilities 汉化文档</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/E-utilities_zh-CN/" aria-label="项目主页"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->项目主页<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/E-utilities_zh-CN/E-utilities_EN/" aria-label="英文文档副本"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-earth-americas" style=""></span><!--]-->英文文档副本<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/E-utilities_zh-CN/E-utilities_zh-CN/" aria-label="汉化文档"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-language" style=""></span><!--]-->汉化文档<!----></a></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/WhyLIM/E-utilities_zh-CN" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/E-utilities_zh-CN/" aria-label="项目主页"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->项目主页<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable"><span class="font-icon icon fa-fw fa-sm fas fa-earth-americas" style=""></span><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/E-utilities_zh-CN/E-utilities_EN/" aria-label="E-utilities 英文文档"><!---->E-utilities 英文文档<!----></a><!----></p><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/E-utilities_zh-CN/E-utilities_EN/01-E-utilities%20Quick%20Start_EN.html" aria-label="E-utilities Quick Start"><!---->E-utilities Quick Start<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/E-utilities_zh-CN/E-utilities_EN/02-A%20General%20Introduction%20to%20the%20E-utilities_EN.html" aria-label="A General Introduction to the E-utilities"><!---->A General Introduction to the E-utilities<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/E-utilities_zh-CN/E-utilities_EN/03-Sample%20Applications%20of%20the%20E-utilities_EN.html" aria-label="Sample Applications of the E-utilities"><!---->Sample Applications of the E-utilities<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/E-utilities_zh-CN/E-utilities_EN/04-The%20E-utilities%20In-Depth_EN.html" aria-label="The E-utilities In-Depth: Parameters, Syntax and More"><!---->The E-utilities In-Depth: Parameters, Syntax and More<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/E-utilities_zh-CN/E-utilities_EN/05-The%20E-utility%20Web%20Service%20(SOAP)_EN.html" aria-label="The E-utility Web Service (SOAP)"><!---->The E-utility Web Service (SOAP)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/E-utilities_zh-CN/E-utilities_EN/06-E-utilities%20on%20the%20Unix%20Command%20Line_EN.html" aria-label="Entrez Direct: E-utilities on the Unix Command Line"><!---->Entrez Direct: E-utilities on the Unix Command Line<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/E-utilities_zh-CN/E-utilities_EN/07-Entrez%20Direct%20Examples_EN.html" aria-label="Entrez Direct Examples"><!---->Entrez Direct Examples<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable active"><span class="font-icon icon fa-fw fa-sm fas fa-language" style=""></span><a class="route-link route-link-active auto-link vp-sidebar-title no-external-link-icon" href="/E-utilities_zh-CN/E-utilities_zh-CN/" aria-label="E-utilities 汉化文档"><!---->E-utilities 汉化文档<!----></a><!----></p><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/E-utilities_zh-CN/E-utilities_zh-CN/01-E-utilities%20Quick%20Start_zh-CN.html" aria-label="E-utilities 快速入门指南"><!---->E-utilities 快速入门指南<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/E-utilities_zh-CN/E-utilities_zh-CN/02-A%20General%20Introduction%20to%20the%20E-utilities_zh-CN.html" aria-label="E-utilities 概述"><!---->E-utilities 概述<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/E-utilities_zh-CN/E-utilities_zh-CN/03-Sample%20Applications%20of%20the%20E-utilities_zh-CN.html" aria-label="E-utilities 示例应用程序"><!---->E-utilities 示例应用程序<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/E-utilities_zh-CN/E-utilities_zh-CN/04-The%20E-utilities%20In-Depth_zh-CN.html" aria-label="E-utilities 深入：参数、语法等"><!---->E-utilities 深入：参数、语法等<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/E-utilities_zh-CN/E-utilities_zh-CN/05-The%20E-utility%20Web%20Service%20(SOAP)_zh-CN.html" aria-label="E-utility Web 服务（SOAP）"><!---->E-utility Web 服务（SOAP）<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/E-utilities_zh-CN/E-utilities_zh-CN/06-E-utilities%20on%20the%20Unix%20Command%20Line_zh-CN.html" aria-label="Entrez Direct：在 Unix 命令行上使用 E-utilities"><!---->Entrez Direct：在 Unix 命令行上使用 E-utilities<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/E-utilities_zh-CN/E-utilities_zh-CN/07-Entrez%20Direct%20Examples_zh-CN.html" aria-label="Entrez Direct 示例"><!---->Entrez Direct 示例<!----></a></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Entrez Direct 示例</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/WhyLIM" target="_blank" rel="noopener noreferrer">WhyLIM</a></span><span property="author" content="WhyLIM"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-07-10T07:54:22.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 25 分钟</span><meta property="timeRequired" content="PT25M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#pubmed">PubMed</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#作者频率">作者频率</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#发表分布">发表分布</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#治疗地点">治疗地点</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#索引日期字段">索引日期字段</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#数字对象标识符">数字对象标识符</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#参考文献格式化">参考文献格式化</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#核苷酸">核苷酸</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#编码序列">编码序列</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#非翻译区序列">非翻译区序列</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-列特征表">5 列特征表</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#wgs-组件">WGS 组件</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#某一区域的蛋白质">某一区域的蛋白质</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#反向互补-genbank">反向互补 GenBank</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#反向互补-ncbi2na">反向互补 NCBI2NA</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#六框蛋白翻译">六框蛋白翻译</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#模式搜索">模式搜索</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#蛋白质">蛋白质</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#氨基酸组成">氨基酸组成</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#最长的序列">最长的序列</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#古细菌酶">古细菌酶</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#基因">基因</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#基因数量">基因数量</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#染色体位置">染色体位置</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#外显子数量">外显子数量</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#每个抗肌萎缩蛋白转录变体中有多少外显子">每个抗肌萎缩蛋白转录变体中有多少外显子？</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#上游序列">上游序列</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#装配">装配</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#完整基因组">完整基因组</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#该过程可以自动化-以循环遍历指定的生物体列表">该过程可以自动化，以循环遍历指定的生物体列表：</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#snp">SNP</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#snp-数据表">SNP 数据表</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#氨基酸取代">氨基酸取代</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#snp-修饰产物对">SNP 修饰产物对</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#结构">结构</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#结构相似性">结构相似性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#分类">分类</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#分类谱系">分类谱系</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#分类搜索">分类搜索</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#生物样本">生物样本</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#sra">SRA</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#使用-runinfo-格式">使用 RunInfo 格式</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#在云上安装-edirect">在云上安装 EDirect</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#下载-blast-软件">下载 BLAST 软件</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#准备染色体文件">准备染色体文件</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#sra-基因分析">SRA 基因分析</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#pubchem">PubChem</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#pubchem-在-entrez-中">PubChem 在 Entrez 中</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#power-user-gateway-pug-rest-查询表单">Power User Gateway (PUG) REST 查询表单</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#pubchem-化学标识符">PubChem 化学标识符</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#pug-rest-异步查询">PUG-REST 异步查询</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#文献计量学">文献计量学</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#倒序排列">倒序排列</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#计算唯一期刊数">计算唯一期刊数</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="entrez-direct-示例" tabindex="-1"><a class="header-anchor" href="#entrez-direct-示例"><span>Entrez Direct 示例</span></a></h1><blockquote><p>Jonathan Kans, PhD.</p><p><a href="https://www.ncbi.nlm.nih.gov/books/NBK565821/#__NBK565821_ai__" target="_blank" rel="noopener noreferrer">作者信息和隶属关系</a></p><p>创建时间：2013 年 4 月 23 日；最后更新：2024 年 4 月 12 日。</p><p><em>预计阅读时间：21 分钟</em></p></blockquote><p>一些早期的 EDirect 示例需要使用 shell 脚本进行后处理：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  start=$(( start + 1 ))</span></span>
<span class="line"><span>  stop=$(( stop + 1 ))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>或 awk 命令：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  awk -F &#39;\t&#39; -v &#39;OFS=\t&#39; &#39;{print $1, $2+1, $3+1}&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>以增加基于 0 的序列坐标，以便检索正确的区域：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  efetch -db nuccore -id $accn -format fasta -seq_start $start -seq_stop $stop</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>这导致了-element 衍生工具，可以在 xtract 命令中进行简单的调整：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  -element ChrAccVer -inc ChrStart -1-based ChrStop</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>以及可以直接采用基于 0 的坐标的 efetch 参数：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  efetch -db nuccore -id $accn -format fasta -chr_start $start -chr_stop $stop</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>这些帮助消除了脚本对提取数据进行简单修改的需要。</p><p>最近的工作允许使用 filter-columns 更轻松地进行事后数值处理：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  filter-columns &#39;10 &lt;= $2 &amp;&amp; $2 &lt;= 30&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>以及 print-columns：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  print-columns &#39;$1, $2+1, $3-1, &quot;\042&quot; $4 &quot;\042&quot;, tolower($5), log($3), total += $2&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>这些脚本接受参数中的列设计器并将其传递给内部的 awk 命令。还可以使用内置变量 NF（字段数）和 NR（当前记录号），以及 YR（年份）和 DT（YYYY-MM-DD 格式的日期）。</p><h2 id="pubmed" tabindex="-1"><a class="header-anchor" href="#pubmed"><span>PubMed</span></a></h2><h3 id="作者频率" tabindex="-1"><a class="header-anchor" href="#作者频率"><span>作者频率</span></a></h3><p>谁是关于响尾蛇磷脂酶的高产作者？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  esearch -db pubmed -query \</span></span>
<span class="line"><span>    &quot;crotalid venoms [MAJR] AND phospholipase [TIAB]&quot; |</span></span>
<span class="line"><span>  efetch -format xml |</span></span>
<span class="line"><span>  xtract -pattern PubmedArticle \</span></span>
<span class="line"><span>    -block Author -sep &quot; &quot; -tab &quot;\n&quot; -element LastName,Initials |</span></span>
<span class="line"><span>  sort-uniq-count-rank</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>将作者名字放在单独的行上允许 sort-uniq-count-rank 生成频率表：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  87    Lomonte B</span></span>
<span class="line"><span>  77    Gutiérrez JM</span></span>
<span class="line"><span>  64    Soares AM</span></span>
<span class="line"><span>  53    Marangoni S</span></span>
<span class="line"><span>  43    Giglio JR</span></span>
<span class="line"><span>  39    Bon C</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="发表分布" tabindex="-1"><a class="header-anchor" href="#发表分布"><span>发表分布</span></a></h3><p>关于军团病的文章最多的年份是什么时候？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  esearch -db pubmed -query &quot;legionnaires disease [TITL]&quot; |</span></span>
<span class="line"><span>  efetch -format docsum |</span></span>
<span class="line"><span>  xtract -pattern DocumentSummary -element PubDate |</span></span>
<span class="line"><span>  cut -c 1-4 |</span></span>
<span class="line"><span>  sort-uniq-count-rank</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这种情况下，sort-uniq-count-rank 报告每年选择的文章数量：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  173    1979</span></span>
<span class="line"><span>  102    1980</span></span>
<span class="line"><span>  96     1978</span></span>
<span class="line"><span>  92     1981</span></span>
<span class="line"><span>  66     1983</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 PubmedArticle 记录上使用‑year &quot;PubDate/*&quot;会取遇到的第一个四位数，结果不需要修剪：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  esearch -db pubmed -query &quot;legionnaires disease [TITL]&quot; |</span></span>
<span class="line"><span>  efetch -format xml |</span></span>
<span class="line"><span>  xtract -pattern PubmedArticle -year &quot;PubDate/*&quot; |</span></span>
<span class="line"><span>  sort-uniq-count-rank</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="治疗地点" tabindex="-1"><a class="header-anchor" href="#治疗地点"><span>治疗地点</span></a></h3><p>脓毒症治疗研究的地理分布是什么？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  esearch -db pubmed -query \</span></span>
<span class="line"><span>    &quot;sepsis/therapy [MESH] AND geographic locations [MESH]&quot; |</span></span>
<span class="line"><span>  efetch -format xml |</span></span>
<span class="line"><span>  xtract -pattern PubmedArticle \</span></span>
<span class="line"><span>    -block MeshHeading -if DescriptorName@Type -equals Geographic \</span></span>
<span class="line"><span>      -tab &quot;\n&quot; -element DescriptorName |</span></span>
<span class="line"><span>  sort-uniq-count-rank</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这将按国家或地区返回文章数量排名：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  660    United States</span></span>
<span class="line"><span>  250    Spain</span></span>
<span class="line"><span>  182    Germany</span></span>
<span class="line"><span>  168    India</span></span>
<span class="line"><span>  155    Taiwan</span></span>
<span class="line"><span>  139    Japan</span></span>
<span class="line"><span>  126    China</span></span>
<span class="line"><span>  124    France</span></span>
<span class="line"><span>  123    Europe</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>请注意，England 和 United Kingdom 将作为两个单独的条目出现。</p><h3 id="索引日期字段" tabindex="-1"><a class="header-anchor" href="#索引日期字段"><span>索引日期字段</span></a></h3><p>PubMed 索引了哪些日期字段？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  einfo -db pubmed |</span></span>
<span class="line"><span>  xtract -pattern Field \</span></span>
<span class="line"><span>    -if IsDate -equals Y -and IsHidden -equals N \</span></span>
<span class="line"><span>      -pfx &quot;[&quot; -sfx &quot;]&quot; -element Name \</span></span>
<span class="line"><span>      -pfx &quot;&quot; -sfx &quot;&quot; -element FullName |</span></span>
<span class="line"><span>  sort -k 2f | expand</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>索引日期显示为字段缩写和描述性名称：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  [CDAT]  Date - Completion</span></span>
<span class="line"><span>  [CRDT]  Date - Create</span></span>
<span class="line"><span>  [EDAT]  Date - Entrez</span></span>
<span class="line"><span>  [MHDA]  Date - MeSH</span></span>
<span class="line"><span>  [MDAT]  Date - Modification</span></span>
<span class="line"><span>  [PDAT]  Date - Publication</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="数字对象标识符" tabindex="-1"><a class="header-anchor" href="#数字对象标识符"><span>数字对象标识符</span></a></h3><p>如何从 PubMed 文章中获取数字对象标识符？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  esearch -db pubmed -query &quot;Rowley JD [AUTH]&quot; |</span></span>
<span class="line"><span>  efetch -format xml |</span></span>
<span class="line"><span>  xtract -head &#39;&lt;html&gt;&lt;body&gt;&#39; -tail &#39;&lt;/body&gt;&lt;/html&gt;&#39; \</span></span>
<span class="line"><span>    -pattern PubmedArticle -PMID MedlineCitation/PMID \</span></span>
<span class="line"><span>      -block ArticleId -if @IdType -equals doi \</span></span>
<span class="line"><span>        -tab &quot;&quot; -pfx &#39;&lt;p&gt;&lt;a href=&quot;&#39; -sfx &#39;&quot;&gt;&#39; -doi ArticleId \</span></span>
<span class="line"><span>        -tab &quot;\n&quot; -pfx &#39;&#39; -sfx &#39;&lt;/a&gt;&lt;/p&gt;&#39; -element &quot;&amp;PMID&quot; |</span></span>
<span class="line"><span>  transmute -format</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>-doi</code> 命令提取 DOI 并构建 URL 引用。这里使用的 <code>-pfx</code> 和 <code>-sfx</code> 参数将每个 PMID 封装在可点击的 DOI 链接中：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span>
<span class="line"><span>  &lt;!DOCTYPE html&gt;</span></span>
<span class="line"><span>  &lt;html&gt;</span></span>
<span class="line"><span>    &lt;body&gt;</span></span>
<span class="line"><span>      &lt;p&gt;</span></span>
<span class="line"><span>        &lt;a href=&quot;https://doi.org/10.1038%2Fleu.2013.340&quot;&gt;24496283&lt;/a&gt;</span></span>
<span class="line"><span>      &lt;/p&gt;</span></span>
<span class="line"><span>      &lt;p&gt;</span></span>
<span class="line"><span>        &lt;a href=&quot;https://doi.org/10.1073%2Fpnas.1310656110&quot;&gt;23818607&lt;/a&gt;</span></span>
<span class="line"><span>      &lt;/p&gt;</span></span>
<span class="line"><span>      ...</span></span>
<span class="line"><span>    &lt;/body&gt;</span></span>
<span class="line"><span>  &lt;/html&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="参考文献格式化" tabindex="-1"><a class="header-anchor" href="#参考文献格式化"><span>参考文献格式化</span></a></h3><p>主 EDirect 文档页面上的参考文献是如何格式化的？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  efetch -db pubmed -format docsum -id 26931183 31738401 31600197 \</span></span>
<span class="line"><span>    29718389 14728215 11449725 8743683 31114887 23175613 |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>相关文档摘要字段收集如下：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  xtract -set Set -rec Rec -pattern DocumentSummary \</span></span>
<span class="line"><span>    -sep &quot;, &quot; -sfx &quot;.&quot; -NM Name -clr \</span></span>
<span class="line"><span>    -sfx &quot;.&quot; -SRC Source -clr \</span></span>
<span class="line"><span>    -pfx &quot;:&quot; -PG Pages -clr \</span></span>
<span class="line"><span>    -pfx &quot;(PMID &quot; -sfx &quot;.)&quot; -ID Id -clr \</span></span>
<span class="line"><span>    -group ArticleId -if IdType -equals doi \</span></span>
<span class="line"><span>      -pfx &quot;https://doi.org/&quot; -sfx &quot;.&quot; -DOI Value -PG &quot;(.)&quot; -clr \</span></span>
<span class="line"><span>    -group DocumentSummary \</span></span>
<span class="line"><span>      -wrp Sort -lower &quot;&amp;NM&quot; \</span></span>
<span class="line"><span>      -wrp Name -element &quot;&amp;NM&quot; \</span></span>
<span class="line"><span>      -wrp Title -element Title \</span></span>
<span class="line"><span>      -wrp Source -element &quot;&amp;SRC&quot; \</span></span>
<span class="line"><span>      -wrp Year -year PubDate \</span></span>
<span class="line"><span>      -wrp Pages -element &quot;&amp;PG&quot; \</span></span>
<span class="line"><span>      -wrp DOI -element &quot;&amp;DOI&quot; \</span></span>
<span class="line"><span>      -wrp Id -element &quot;&amp;ID&quot; |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这生成了带有部分格式化的中间 XML：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  ...</span></span>
<span class="line"><span>  &lt;Rec&gt;</span></span>
<span class="line"><span>    &lt;Sort&gt;wei ch, allot a, leaman r, lu z.&lt;/Sort&gt;</span></span>
<span class="line"><span>    &lt;Name&gt;Wei CH, Allot A, Leaman R, Lu Z.&lt;/Name&gt;</span></span>
<span class="line"><span>    &lt;Title&gt;PubTator central: automated concept ... full text articles.&lt;/Title&gt;</span></span>
<span class="line"><span>    &lt;Source&gt;Nucleic Acids Res.&lt;/Source&gt;</span></span>
<span class="line"><span>    &lt;Year&gt;2019&lt;/Year&gt;</span></span>
<span class="line"><span>    &lt;Pages&gt;.&lt;/Pages&gt;</span></span>
<span class="line"><span>    &lt;DOI&gt;https://doi.org/10.1093/nar/gkz389.&lt;/DOI&gt;</span></span>
<span class="line"><span>    &lt;Id&gt;(PMID 31114887.)&lt;/Id&gt;</span></span>
<span class="line"><span>  &lt;/Rec&gt;</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>参考文献按第一作者的姓氏排序：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  xtract -set Set -rec Rec -pattern Rec -sort Sort |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>然后用以下命令打印：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  xtract -pattern Rec -deq &quot;\n\n&quot; -tab &quot; &quot; -sep &quot;&quot; \</span></span>
<span class="line"><span>    -element Name Title Source Year,Pages DOI Id</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>然后手动编辑连字符缩写：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  ...</span></span>
<span class="line"><span>  Wei C-H, Allot A, Leaman R, Lu Z. PubTator central: automated concept</span></span>
<span class="line"><span>  annotation for biomedical full text articles. Nucleic Acids Res. 2019.</span></span>
<span class="line"><span>  https://doi.org/10.1093/nar/gkz389. (PMID 31114887.)</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 xtract <strong>-reg</strong> 和 <strong>-exp</strong> 正则表达式指导 xtract <strong>-replace</strong>：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  efetch -db pubmed -id 31114887 -format xml |</span></span>
<span class="line"><span>  xtract -pattern PubmedArticle -block Author -deq &quot;\n&quot; \</span></span>
<span class="line"><span>    -element LastName -reg &quot;[a-z .]&quot; -exp &quot;&quot; -replace ForeName</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以直接从 PubmedArticle 的 ForeName 字段生成连字符缩写：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  &lt;Author&gt;</span></span>
<span class="line"><span>    &lt;LastName&gt;Wei&lt;/LastName&gt;</span></span>
<span class="line"><span>    &lt;ForeName&gt;Chih-Hsuan&lt;/ForeName&gt;</span></span>
<span class="line"><span>    &lt;Initials&gt;CH&lt;/Initials&gt;</span></span>
<span class="line"><span>  &lt;/Author&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过删除小写字母、空格和句点来实现。</p><h2 id="核苷酸" tabindex="-1"><a class="header-anchor" href="#核苷酸"><span>核苷酸</span></a></h2><h3 id="编码序列" tabindex="-1"><a class="header-anchor" href="#编码序列"><span>编码序列</span></a></h3><p><em>大肠杆菌</em>的乳糖操纵子中的编码序列是什么？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  efetch -db nuccore -id J01636.1 -format gbc |</span></span>
<span class="line"><span>  xtract -insd CDS gene sub_sequence</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>使用-insd &quot;sub_sequence&quot; 参数在特征位置下获取序列：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  J01636.1    lacI    GTGAAACCAGTAACGTTATACGATGTCGCAGAGTATGCCG...</span></span>
<span class="line"><span>  J01636.1    lacZ    ATGACCATGATTACGGATTCACTGGCCGTCGTTTTACAAC...</span></span>
<span class="line"><span>  J01636.1    lacY    ATGTACTATTTAAAAAACACAAACTTTTGGATGTTCGGTT...</span></span>
<span class="line"><span>  J01636.1    lacA    TTGAACATGCCAATGACCGAAAGAATAAGAGCAGGCAAGC...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="非翻译区序列" tabindex="-1"><a class="header-anchor" href="#非翻译区序列"><span>非翻译区序列</span></a></h3><p>番茄红素环化酶 mRNA 的 5&#39;和 3&#39; UTR 序列是什么？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  SubSeq() {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    xtract -pattern INSDSeq -ACC INSDSeq_accession-version -SEQ INSDSeq_sequence \</span></span>
<span class="line"><span>      -group INSDFeature -if INSDFeature_key -equals CDS -PRD &quot;(-)&quot; \</span></span>
<span class="line"><span>        -block INSDQualifier -if INSDQualifier_name -equals product \</span></span>
<span class="line"><span>          -PRD INSDQualifier_value \</span></span>
<span class="line"><span>        -block INSDFeature -pfc &quot;\n&quot; -element &quot;&amp;ACC&quot; -rst \</span></span>
<span class="line"><span>          -first INSDInterval_from -last INSDInterval_to -element &quot;&amp;PRD&quot; &quot;&amp;SEQ&quot;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  UTRs() {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    while IFS=$&#39;\t&#39; read acc fst lst prd seq</span></span>
<span class="line"><span>    do</span></span>
<span class="line"><span>      if [ $fst -gt 1 ]</span></span>
<span class="line"><span>      then</span></span>
<span class="line"><span>        echo -e &quot;&gt;$acc 5&#39;UTR: 1..$((fst-1)) $prd&quot;</span></span>
<span class="line"><span>        echo &quot;${seq:1:$((fst-2))}&quot; | fold -w 50</span></span>
<span class="line"><span>      else</span></span>
<span class="line"><span>        echo -e &quot;&gt;$acc NO 5&#39;UTR&quot;</span></span>
<span class="line"><span>      fi</span></span>
<span class="line"><span>      if [ $lst -lt ${#seq} ]</span></span>
<span class="line"><span>      then</span></span>
<span class="line"><span>        echo -e &quot;&gt;$acc 3&#39;UTR: $((lst+1))..${#seq} $prd&quot;</span></span>
<span class="line"><span>        echo &quot;${seq:$lst}&quot; | fold -w 50</span></span>
<span class="line"><span>      else</span></span>
<span class="line"><span>        echo -e &quot;&gt;$acc NO 3&#39;UTR&quot;</span></span>
<span class="line"><span>      fi</span></span>
<span class="line"><span>    done</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  esearch -db nuccore -query &quot;5.5.1.19 [ECNO]&quot; |</span></span>
<span class="line"><span>  efilter -molecule mrna -feature cds -source refseq |</span></span>
<span class="line"><span>  efetch -format gbc |</span></span>
<span class="line"><span>  SubSeq | UTRs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在起始密码子前和终止密码子后的序列通过 Unix 子字符串命令获得：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  &gt;NM_001324787.1 NO 5&#39;UTR</span></span>
<span class="line"><span>  &gt;NM_001324787.1 NO 3&#39;UTR</span></span>
<span class="line"><span>  &gt;NM_001324979.1 5&#39;UTR: 1..262 lycopene beta cyclase, chloroplastic/chromoplastic</span></span>
<span class="line"><span>  attatagaaatacttaagatatatcattgccctttaatcatttattttta</span></span>
<span class="line"><span>  actcttttaagtgtttaaagattgattctttgtacatgttctgcttcatt</span></span>
<span class="line"><span>  tgtgttgaaaattgagttgttttcttgaattttgcaagaatataggggac</span></span>
<span class="line"><span>  cccatttgtgttgaaaattgagcagctttctttgtgttttgttcgatttt</span></span>
<span class="line"><span>  tcaagaatataggaccccattttctgttttcttgagataaattgcacctt</span></span>
<span class="line"><span>  gttgggaaaat</span></span>
<span class="line"><span>  &gt;NM_001324979.1 3&#39;UTR: 1760..1782 lycopene beta cyclase, chloroplastic/chromoplastic</span></span>
<span class="line"><span>  attcgacttatctgggatcttgt</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-列特征表" tabindex="-1"><a class="header-anchor" href="#_5-列特征表"><span>5 列特征表</span></a></h3><p>如何从 GenBank 格式生成 5 列特征表？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  XtoT() {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    xtract -pattern INSDSeq -pfx &quot;&gt;Feature &quot; \</span></span>
<span class="line"><span>        -first INSDSeqid,INSDSeq_accession-version \</span></span>
<span class="line"><span>      -group INSDFeature -FKEY INSDFeature_key \</span></span>
<span class="line"><span>        -block INSDInterval -deq &quot;\n&quot; \</span></span>
<span class="line"><span>          -element INSDInterval_from INSDInterval_to \</span></span>
<span class="line"><span>            INSDInterval_point INSDInterval_point \</span></span>
<span class="line"><span>            &quot;&amp;FKEY&quot; -FKEY &quot;()&quot; \</span></span>
<span class="line"><span>        -block INSDQualifier -deq &quot;\n\t\t\t&quot; \</span></span>
<span class="line"><span>          -element INSDQualifier_name INSDQualifier_value</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  efetch -db nuccore -id U54469 -format gb |</span></span>
<span class="line"><span>  transmute -g2x |</span></span>
<span class="line"><span>  XtoT</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>探索 INSDSeq XML 层次结构，使用<code>-pattern {sequence} -group {feature} -block {qualifier}</code>构造，并添加适当的缩进，可以生成特征表提交格式：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  &gt;Feature U54469.1</span></span>
<span class="line"><span>  1       2881    source</span></span>
<span class="line"><span>                            organism      Drosophila melanogaster</span></span>
<span class="line"><span>                            mol_type      genomic DNA</span></span>
<span class="line"><span>                            db_xref       taxon:7227</span></span>
<span class="line"><span>                            chromosome    3</span></span>
<span class="line"><span>                            map           67A8-B2</span></span>
<span class="line"><span>  80      2881    gene</span></span>
<span class="line"><span>                            gene          eIF4E</span></span>
<span class="line"><span>  80      224     mRNA</span></span>
<span class="line"><span>  892     1458</span></span>
<span class="line"><span>  1550    1920</span></span>
<span class="line"><span>  1986    2085</span></span>
<span class="line"><span>  2317    2404</span></span>
<span class="line"><span>  2466    2881</span></span>
<span class="line"><span>                            gene          eIF4E</span></span>
<span class="line"><span>                            product       eukaryotic initiation factor 4E-I</span></span>
<span class="line"><span>                            ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>包含此 xtract 命令的 <strong>xml2tbl</strong> 脚本现在已包含在 EDirect 中。</p><h3 id="wgs-组件" tabindex="-1"><a class="header-anchor" href="#wgs-组件"><span>WGS 组件</span></a></h3><p>如何获取 WGS 项目所有组件的 FASTA 格式？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  GenerateWGSAccessions() {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    gb=$( efetch -db nuccore -id &quot;$1&quot; -format gbc &lt; /dev/null )</span></span>
<span class="line"><span>    ln=$( echo &quot;$gb&quot; | xtract -pattern INSDSeq -element INSDSeq_length )</span></span>
<span class="line"><span>    pf=$(</span></span>
<span class="line"><span>      echo &quot;$gb&quot; |</span></span>
<span class="line"><span>      xtract -pattern INSDSeq -element INSDSeq_locus |</span></span>
<span class="line"><span>      sed -e &#39;s/010*/01/g&#39;</span></span>
<span class="line"><span>    )</span></span>
<span class="line"><span>    seq -f &quot;${pf}%07.0f&quot; 1 &quot;$ln&quot;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  GenerateWGSAccessions &quot;JABRPF000000000&quot; |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>返回来自 WGS 主控的扩展访问列表：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  JABRPF010000001</span></span>
<span class="line"><span>  JABRPF010000002</span></span>
<span class="line"><span>  JABRPF010000003</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  JABRPF010000061</span></span>
<span class="line"><span>  JABRPF010000062</span></span>
<span class="line"><span>  JABRPF010000063</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>将这些访问列表管道到：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  efetch -db nuccore -format fasta</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>以 FASTA 格式检索各个组件：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  &gt;JABRPF010000001.1 Enterococcus faecalis strain G109-2 contig00001, ...</span></span>
<span class="line"><span>  ACACTAATATGTGTCTTTTTAGACACTAGCTCACTAAAAAAAATAGTCATAATTTCTTCATTATTAAAAT</span></span>
<span class="line"><span>  CCAACAATTGTGAAATCAATTTAATATCCGATGCTTTGAAAACAACTTCTCCTTTTAATTTTTTGTAAAT</span></span>
<span class="line"><span>  CGTTGAAGCGGATATTGGTTGCCCGTATGCAGTCATTTCATTTGCCAACCACTCAACATTTTTTCCTTTC</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="某一区域的蛋白质" tabindex="-1"><a class="header-anchor" href="#某一区域的蛋白质"><span>某一区域的蛋白质</span></a></h3><p>如何获取在特定核苷酸序列区域内编码的蛋白质记录？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  efetch -db nuccore -id NC_015162.1 -format gb -seq_start 9125 -seq_stop 103803 |</span></span>
<span class="line"><span>  xtract -insd CDS protein_id |</span></span>
<span class="line"><span>  cut -f 2 |</span></span>
<span class="line"><span>  efetch -db protein -format fasta</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>提取 protein_id 访问号并以 FASTA 格式检索这些蛋白质：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  &gt;WP_013615770.1 hypothetical protein [Deinococcus proteolyticus]</span></span>
<span class="line"><span>  MTQNASAGLTAETLMTETGLSAAAVRRALKAYDAAFGLEHPTQDGELHLTPAEYDVLRRALQLTGGYAPG</span></span>
<span class="line"><span>  LKLWFGEQQALALSTQPVASPREVQQLSQLYQQVESYRARPPEEPAQTLRALLDQAQALGWSGFWEMGRL</span></span>
<span class="line"><span>  QGAALFVLGVLRFEDGQRAKVSMQTPLSGAEALVLSRGVCALLQRVRTQPGSGQAWSWNEVLLEEVERIL</span></span>
<span class="line"><span>  KDLTE</span></span>
<span class="line"><span>  &gt;WP_013615771.1 hypothetical protein [Deinococcus proteolyticus]</span></span>
<span class="line"><span>  MNKDTNVDTAFAGGFFTTFENGECVFYDADGVCHSVTPDTVAAVVASGTPRDVVALHEDVQGRTDAVAQV</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="反向互补-genbank" tabindex="-1"><a class="header-anchor" href="#反向互补-genbank"><span>反向互补 GenBank</span></a></h3><p>如何反向互补 GenBank 格式的核苷酸序列？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  efetch -db nuccore -id J01749 -format gb |</span></span>
<span class="line"><span>  gbf2fsa |</span></span>
<span class="line"><span>  transmute -revcomp |</span></span>
<span class="line"><span>  transmute -fasta -width 50</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>将 GenBank 转换为 FASTA，反向互补序列，并以每行 50 个字符的格式保存：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  TTCTTGAAGACGAAAGGGCCTCGTGATACGCCTATTTTTATAGGTTAATG</span></span>
<span class="line"><span>  TCATGATAATAATGGTTTCTTAGACGTCAGGTGGCACTTTTCGGGGAAAT</span></span>
<span class="line"><span>  GTGCGCGGAACCCCTATTTGTTTATTTTTCTAAATACATTCAAATATGTA</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  ACGATGAGCGCATTGTTAGATTTCATACACGGTGCCTGACTGCGTTAGCA</span></span>
<span class="line"><span>  ATTTAACTGTGATAAACTACCGCATTAAAGCTTATCGATGATAAGCTGTC</span></span>
<span class="line"><span>  AAACATGAGAA</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="反向互补-ncbi2na" tabindex="-1"><a class="header-anchor" href="#反向互补-ncbi2na"><span>反向互补 NCBI2NA</span></a></h3><p>如何反向互补 2 位编码的核苷酸序列？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  efetch -db nuccore -id J01749 -format asn |</span></span>
<span class="line"><span>  xtract -pattern Seq-entry \</span></span>
<span class="line"><span>    -group seq -if ncbi2na \</span></span>
<span class="line"><span>      -block inst -LEN length -SEQ -ncbi2na ncbi2na \</span></span>
<span class="line"><span>        -SUB &quot;&amp;SEQ[:&amp;LEN]&quot; -REV -revcomp &quot;&amp;SUB&quot; \</span></span>
<span class="line"><span>        -sep &quot;\n&quot; -fasta &quot;&amp;REV&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>扩展 NCBI2NA 表示为 IUPACNA，截断为指示的长度，反向互补该序列，并以默认的每行 70 个字符保存：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  TTCTTGAAGACGAAAGGGCCTCGTGATACGCCTATTTTTATAGGTTAATGTCATGATAATAATGGTTTCT</span></span>
<span class="line"><span>  TAGACGTCAGGTGGCACTTTTCGGGGAAATGTGCGCGGAACCCCTATTTGTTTATTTTTCTAAATACATT</span></span>
<span class="line"><span>  CAAATATGTATCCGCTCATGAGACAATAACCCTGATAAATGCTTCAATAATATTGAAAAAGGAAGAGTAT</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  GCATAACCAAGCCTATGCCTACAGCATCCAGGGTGACGGTGCCGAGGATGACGATGAGCGCATTGTTAGA</span></span>
<span class="line"><span>  TTTCATACACGGTGCCTGACTGCGTTAGCAATTTAACTGTGATAAACTACCGCATTAAAGCTTATCGATG</span></span>
<span class="line"><span>  ATAAGCTGTCAAACATGAGAA</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="六框蛋白翻译" tabindex="-1"><a class="header-anchor" href="#六框蛋白翻译"><span>六框蛋白翻译</span></a></h3><p>如何翻译核苷酸序列的所有六个阅读框？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  efetch -db nuccore -id J01749 -format fasta |</span></span>
<span class="line"><span>  transmute -cds2prot -circular -gcode 11 -all</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>将同时翻译三个正链和三个负链的阅读框，包括跨越原点的密码子（如果分子是环形的）：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  &gt;J01749.1-1+</span></span>
<span class="line"><span>  FSCLTAYHR*ALMR*FITVKLLTQSGTVYE ... KCHLTSKKPLLS*H*PIKIGVSRGPFVFKN</span></span>
<span class="line"><span>  &gt;J01749.1-2+</span></span>
<span class="line"><span>  SHV*QLIIDKL*CGSLSQLNC*RSQAPCMK ... SAT*RLRNHYYHDINL*K*AYHEALSSSRI</span></span>
<span class="line"><span>  &gt;J01749.1-3+</span></span>
<span class="line"><span>  LMFDSLSSISFNAVVYHS*IANAVRHRV*N ... VPPDV*ETIIIMTLTYKNRRITRPFRLQEF</span></span>
<span class="line"><span>  &gt;J01749.1-1-</span></span>
<span class="line"><span>  ILEDERAS*YAYFYRLMS***WFLRRQVAL ... FIHGA*LR*QFNCDKLPH*SLSMISCQT*E</span></span>
<span class="line"><span>  &gt;J01749.1-2-</span></span>
<span class="line"><span>  NS*RRKGLVIRLFL*VNVMIIMVS*TSGGT ... FHTRCLTALAI*L**TTALKLIDDKLSNMR</span></span>
<span class="line"><span>  &gt;J01749.1-3-</span></span>
<span class="line"><span>  EFLKTKGPRDTPIFIG*CHDNNGFLDVRWH ... ISYTVPDCVSNLTVINYRIKAYR**AVKHE</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="模式搜索" tabindex="-1"><a class="header-anchor" href="#模式搜索"><span>模式搜索</span></a></h3><p>pBR322 克隆载体是一个圆形质粒，在两个抗生素抗性基因中具有唯一的限制酶位点。</p><p><code>transmute -replace</code>函数通过修改 pBR322 rop（质粒复制数限制酶）基因的核糖体结合位点，引入第二个 BamHI 限制酶识别位点：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span> efetch -db nuccore -id J01749 -format fasta |</span></span>
<span class="line"><span>  transmute -replace -offset 1907 -delete GG -insert TC |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>transmute -search</code>函数接受带有可选标签（例如限制酶名称）的序列模式列表，并使用有限状态算法同时搜索所有模式：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  transmute -search -circular GGATCC:BamHI GAATTC:EcoRI CTGCAG:PstI |</span></span>
<span class="line"><span>  align-columns -g 4 -a rl</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>然后打印（0 基）起始位置和每个匹配项的标签，形成一个两列表：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>   374    BamHI</span></span>
<span class="line"><span>  1904    BamHI</span></span>
<span class="line"><span>  3606    PstI</span></span>
<span class="line"><span>  4358    EcoRI</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>disambiguate-nucleotides</strong> 和 <strong>systematic-mutations</strong> 脚本可以生成模式中的所有可能单碱基替代，以进行更宽松的搜索。</p><h2 id="蛋白质" tabindex="-1"><a class="header-anchor" href="#蛋白质"><span>蛋白质</span></a></h2><h3 id="氨基酸组成" tabindex="-1"><a class="header-anchor" href="#氨基酸组成"><span>氨基酸组成</span></a></h3><p>人类 titin 的氨基酸组成是什么？</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  #!/bin/bash -norc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  AAComp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    abbrev</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">( </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Ala</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Asx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Cys</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Asp</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Glu</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Phe</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Gly</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> His</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Ile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> \</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             Xle</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Lys</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Leu</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Met</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Asn</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Pyl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Gln</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Arg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> \</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             Ser</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Thr</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Sec</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Val</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Trp</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Xxx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Tyr</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Glx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    tr</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> A-Z</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> a-z</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    sed</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;s/[^a-z]//g&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    fold</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -w</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    sort-uniq-count</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    while</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> read</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> num</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lttr</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    do</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      idx</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">printf</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> %i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">$lttr</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      ofs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">$((</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">idx-97</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">      echo</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">abbrev</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">$ofs</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">]}\t</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">$num</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    done</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    sort</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  efetch</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -db</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> protein</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -id</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Q8WZ42</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -format</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gpc</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  xtract</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -pattern</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> INSDSeq</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -element</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> INSDSeq_sequence</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  AAComp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这会使用三字母氨基酸缩写生成一个残基计数表：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  Ala    2084</span></span>
<span class="line"><span>  Arg    1640</span></span>
<span class="line"><span>  Asn    1111</span></span>
<span class="line"><span>  Asp    1720</span></span>
<span class="line"><span>  Cys    513</span></span>
<span class="line"><span>  Gln    942</span></span>
<span class="line"><span>  Glu    3193</span></span>
<span class="line"><span>  Gly    2066</span></span>
<span class="line"><span>  His    478</span></span>
<span class="line"><span>  Ile    2062</span></span>
<span class="line"><span>  Leu    2117</span></span>
<span class="line"><span>  Lys    2943</span></span>
<span class="line"><span>  Met    398</span></span>
<span class="line"><span>  Phe    908</span></span>
<span class="line"><span>  Pro    2517</span></span>
<span class="line"><span>  Ser    2463</span></span>
<span class="line"><span>  Thr    2546</span></span>
<span class="line"><span>  Trp    466</span></span>
<span class="line"><span>  Tyr    999</span></span>
<span class="line"><span>  Val    3184</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="最长的序列" tabindex="-1"><a class="header-anchor" href="#最长的序列"><span>最长的序列</span></a></h3><p>已知最长的胰岛素前体分子是什么？</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  esearch</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -db</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> protein</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -query</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;insulin [PROT]&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  efetch</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -format</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> docsum</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  xtract</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -pattern</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DocumentSummary</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -element</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Caption</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Slen</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Title</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> receptor</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> sort</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -k</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 2,2nr</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> head</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  xargs</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;efetch -db protein -id &quot;$0&quot; -format gp &gt; &quot;$0&quot;.gpf&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>后处理排除了较长的“胰岛素样受体”序列，按序列长度排序，并使用右尖括号（“<strong>&gt;</strong>”）Unix 输出重定向字符将 GenPept 结果保存到以其序列访问号命名的单个文件中：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  EFN61235.gpf</span></span>
<span class="line"><span>  EFN80340.gpf</span></span>
<span class="line"><span>  EGW08477.gpf</span></span>
<span class="line"><span>  EKC18433.gpf</span></span>
<span class="line"><span>  ELK28555.gpf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="古细菌酶" tabindex="-1"><a class="header-anchor" href="#古细菌酶"><span>古细菌酶</span></a></h3><p>哪些古细菌具有氯霉素乙酰转移酶？</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  esearch</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -db</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> protein</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -organism</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> archaea</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    -query</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;chloramphenicol acetyltransferase [PROT]&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  efetch</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -format</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gpc</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  xtract</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -pattern</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> INSDSeq</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -element</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> INSDSeq_organism</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> INSDSeq_definition</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> chloramphenicol</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MULTISPECIES</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> sort</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> uniq</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -i</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>根据定义行进行筛选生成古菌有机体名称列表：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  Euryarchaeota archaeon</span></span>
<span class="line"><span>  Methanobrevibacter arboriphilus</span></span>
<span class="line"><span>  Methanobrevibacter gottschalkii</span></span>
<span class="line"><span>  Methanobrevibacter millerae</span></span>
<span class="line"><span>  Methanobrevibacter oralis</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="基因" tabindex="-1"><a class="header-anchor" href="#基因"><span>基因</span></a></h2><h3 id="基因数量" tabindex="-1"><a class="header-anchor" href="#基因数量"><span>基因数量</span></a></h3><p>每个人类染色体上有多少基因？</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> chr</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">1..22}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> X</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Y</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  do</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    esearch</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -db</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gene</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -query</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Homo sapiens [ORGN] AND </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">$chr</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> [CHR]&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    efilter</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -status</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> alive</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> coding</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    efetch</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -format</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> docsum</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    xtract</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -pattern</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DocumentSummary</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Name</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      -block</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GenomicInfoType</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -if</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ChrLoc</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -equals</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">$chr</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">        -tab</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;\n&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -element</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ChrLoc,&quot;&amp;NAME&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    sort</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> uniq</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    sort-uniq-count-rank</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    reorder-columns</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  done</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这会返回每条染色体上独特蛋白编码基因的数量：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  1     2011</span></span>
<span class="line"><span>  2     1224</span></span>
<span class="line"><span>  3     1046</span></span>
<span class="line"><span>  4     742</span></span>
<span class="line"><span>  5     854</span></span>
<span class="line"><span>  6     1015</span></span>
<span class="line"><span>  7     911</span></span>
<span class="line"><span>  8     666</span></span>
<span class="line"><span>  9     763</span></span>
<span class="line"><span>  10    718</span></span>
<span class="line"><span>  11    1279</span></span>
<span class="line"><span>  12    1012</span></span>
<span class="line"><span>  13    327</span></span>
<span class="line"><span>  14    601</span></span>
<span class="line"><span>  15    585</span></span>
<span class="line"><span>  16    835</span></span>
<span class="line"><span>  17    1147</span></span>
<span class="line"><span>  18    266</span></span>
<span class="line"><span>  19    1391</span></span>
<span class="line"><span>  20    528</span></span>
<span class="line"><span>  21    232</span></span>
<span class="line"><span>  22    429</span></span>
<span class="line"><span>  X     839</span></span>
<span class="line"><span>  Y     63</span></span>
<span class="line"><span>  MT    13</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>范围构造不能用于罗马数字，所以相应的<em>酿酒酵母</em>查询需要显式列出所有染色体，包括线粒体：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> chr</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> I</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> II</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> III</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> IV</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> V</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> VI</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> VII</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> VIII</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> IX</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> X</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> XI</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> XII</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> XIII</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> XIV</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> XV</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> XVI</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MT</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>质体基因可以使用“source plastid [PROP]”或<code>-location plastid</code>进行选择。</p><h3 id="染色体位置" tabindex="-1"><a class="header-anchor" href="#染色体位置"><span>染色体位置</span></a></h3><p>哺乳动物钙调素基因位于何处？</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  esearch</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -db</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gene</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -query</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;calmodulin * [PFN] AND mammalia [ORGN]&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  efetch</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -format</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> docsum</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  xtract</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -pattern</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DocumentSummary</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    -def</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;-&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -element</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Id</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Name</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MapLocation</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ScientificName</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>-def</code>命令添加一个破折号以防止缺失数据导致表中的列偏移：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  801</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       CALM1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     14q32.11</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Homo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sapiens</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  808</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       CALM3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     19q13.32</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Homo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sapiens</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  805</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       CALM2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     2p21</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">         Homo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sapiens</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  24242</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Calm1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     6q32</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">         Rattus</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> norvegicus</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  12313</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Calm1</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     12</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> E</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">         Mus</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> musculus</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  50663</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Calm2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     6q12</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">         Rattus</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> norvegicus</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  24244</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Calm3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     1q21</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">         Rattus</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> norvegicus</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  12315</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Calm3</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     7</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9.15</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cM</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Mus</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> musculus</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  12314</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Calm2</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     17</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> E4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Mus</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> musculus</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  80796</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Calm4</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     13</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> A1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Mus</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> musculus</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  617095</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    CALM1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     -</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            Bos</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> taurus</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  396838</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    CALM3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     -</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            Sus</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> scrofa</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  520277</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    CALM3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     -</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            Bos</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> taurus</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  364774</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Calml5</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    17q12.2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      Rattus</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> norvegicus</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="外显子数量" tabindex="-1"><a class="header-anchor" href="#外显子数量"><span>外显子数量</span></a></h3><h3 id="每个抗肌萎缩蛋白转录变体中有多少外显子" tabindex="-1"><a class="header-anchor" href="#每个抗肌萎缩蛋白转录变体中有多少外显子"><span>每个抗肌萎缩蛋白转录变体中有多少外显子？</span></a></h3><p>以下命令从基因区域检索到一个 INSDSeq XML 子集记录，其中包含多个选择性剪接的抗肌萎缩蛋白 mRNA 和 CDS 特征。</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  esearch -db gene -query &quot;DMD [GENE] AND human [ORGN]&quot; |</span></span>
<span class="line"><span>  efetch -format docsum |</span></span>
<span class="line"><span>  xtract -pattern DocumentSummary -block GenomicInfoType \</span></span>
<span class="line"><span>    -tab &quot;\n&quot; -element ChrAccVer,ChrStart,ChrStop |</span></span>
<span class="line"><span>  xargs -n 3 sh -c &#39;efetch -db nuccore -format gbc \</span></span>
<span class="line"><span>    -id &quot;$0&quot; -chr_start &quot;$1&quot; -chr_stop &quot;$2&quot;&#39; |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>数据提取计算每个 mRNA 位置的间隔数（包括单个外显子和不相邻的 UTRs），并从限定符中获取转录序列登录号、转录长度和产物名称：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  xtract -insd complete mRNA &quot;#INSDInterval&quot; \</span></span>
<span class="line"><span>    transcript_id &quot;%transcription&quot; product |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>最后过滤和排序：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  grep -i dystrophin |</span></span>
<span class="line"><span>  sed &#39;s/dystrophin, transcript variant //g&#39; |</span></span>
<span class="line"><span>  sort -k 2,2nr -k 4,4nr</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>生成外显子数量和转录长度的表格：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  NC_000023.11    79    NM_004010.3       14083    Dp427p2</span></span>
<span class="line"><span>  NC_000023.11    79    NM_004009.3       14000    Dp427p1</span></span>
<span class="line"><span>  NC_000023.11    79    NM_004006.3       13992    Dp427m</span></span>
<span class="line"><span>  NC_000023.11    79    NM_000109.4       13854    Dp427c</span></span>
<span class="line"><span>  NC_000023.11    78    XM_006724468.2    13923    X1</span></span>
<span class="line"><span>  NC_000023.11    78    XM_017029328.1    13916    X4</span></span>
<span class="line"><span>  NC_000023.11    78    XM_006724469.3    13897    X2</span></span>
<span class="line"><span>  NC_000023.11    77    XM_006724470.3    13875    X3</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="上游序列" tabindex="-1"><a class="header-anchor" href="#上游序列"><span>上游序列</span></a></h3><p>苯丙氨酸羟化酶基因的上游序列是什么？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  esearch -db nuccore -query &quot;U49897 [ACCN]&quot; |</span></span>
<span class="line"><span>  elink -target gene |</span></span>
<span class="line"><span>  elink -target homologene |</span></span>
<span class="line"><span>  elink -target gene |</span></span>
<span class="line"><span>  efetch -format docsum |</span></span>
<span class="line"><span>  xtract -pattern DocumentSummary -if GenomicInfoType -element Id \</span></span>
<span class="line"><span>    -block GenomicInfoType -element ChrAccVer -1-based ChrStart ChrStop |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这会生成一个以 1 为基数的序列坐标表：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  5053       NC_000012.12    102958441    102836889</span></span>
<span class="line"><span>  18478      NC_000076.7     87357657     87419999</span></span>
<span class="line"><span>  38871      NT_037436.4     7760453      7763166</span></span>
<span class="line"><span>  24616      NC_005106.4     28066639     28129772</span></span>
<span class="line"><span>  378962     NC_007115.7     17409367     17391680</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后，给定一个名为 &quot;upstream.sh&quot; 的 shell 脚本：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  #!/bin/bash -norc</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  bases=1500</span></span>
<span class="line"><span>  if [ -n &quot;$1&quot; ]</span></span>
<span class="line"><span>  then</span></span>
<span class="line"><span>    bases=&quot;$1&quot;</span></span>
<span class="line"><span>  fi</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  while read id accn start stop</span></span>
<span class="line"><span>  do</span></span>
<span class="line"><span>    if [ $start -eq 0 ] || [ $stop -eq 0 ] || [ $start -eq $stop ]</span></span>
<span class="line"><span>    then</span></span>
<span class="line"><span>      echo &quot;Skipping $id due to ambiguous coordinates&quot;</span></span>
<span class="line"><span>      continue</span></span>
<span class="line"><span>    fi</span></span>
<span class="line"><span>    if [ $start -gt $stop ]</span></span>
<span class="line"><span>    then</span></span>
<span class="line"><span>      stop=$(( start + bases ))</span></span>
<span class="line"><span>      start=$(( start + 1 ))</span></span>
<span class="line"><span>      strand=2</span></span>
<span class="line"><span>    else</span></span>
<span class="line"><span>      stop=$(( start - 1 ))</span></span>
<span class="line"><span>      start=$(( start - bases ))</span></span>
<span class="line"><span>      strand=1</span></span>
<span class="line"><span>    fi</span></span>
<span class="line"><span>    rslt=$( efetch -db nuccore -id $accn -format fasta \</span></span>
<span class="line"><span>            -seq_start $start -seq_stop $stop -strand $strand &lt; /dev/null )</span></span>
<span class="line"><span>    echo &quot;$rslt&quot;</span></span>
<span class="line"><span>  done</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>数据行可以通过以下命令管道传输：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  upstream.sh 500</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>提取和打印每个基因上游的 500 个核苷酸：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  &gt;NC_000012.12:c102958941-102958442 Homo sapiens chromosome 12, GRCh38.p13 ...</span></span>
<span class="line"><span>  TGAAGTCGAGAAGCTCCTGCTCCTCGGGGCTGAGCGGGTCGTAAGAGCCCTCGTCCGACGAGTAGGATGA</span></span>
<span class="line"><span>  GACCGGCGAGCCGGCCATGGAGTTCAAGTCGTTGGAGTAGTTGGGGGAGATGGTGGGCGACAGGACGCCT</span></span>
<span class="line"><span>  GCCTGGAAGGCGGCGCTCACCGCGTCATGCTCGTCCAGCAGCTGCTGCAGCGCGCGGATGTACTCGACCG</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="装配" tabindex="-1"><a class="header-anchor" href="#装配"><span>装配</span></a></h2><h3 id="完整基因组" tabindex="-1"><a class="header-anchor" href="#完整基因组"><span>完整基因组</span></a></h3><p>有哪些完整基因组可用于 <em>大肠杆菌</em>？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  esearch -db assembly -query \</span></span>
<span class="line"><span>    &quot;Escherichia coli [ORGN] AND representative [PROP]&quot; |</span></span>
<span class="line"><span>  elink -target nuccore -name assembly_nuccore_refseq |</span></span>
<span class="line"><span>  efetch -format docsum |</span></span>
<span class="line"><span>  xtract -pattern DocumentSummary -element AccessionVersion Slen Title |</span></span>
<span class="line"><span>  sed &#39;s/,.*//&#39; |</span></span>
<span class="line"><span>  sort-table -k 2,2nr</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>此搜索找到基因组装配并按序列长度排序结果，使完整基因组可以轻松与较小的质粒区分开来：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  NC_002695.2    5498578    Escherichia coli O157:H7 str. Sakai DNA</span></span>
<span class="line"><span>  NC_000913.3    4641652    Escherichia coli str. K-12 substr. MG1655</span></span>
<span class="line"><span>  NC_002128.1    92721      Escherichia coli O157:H7 str. Sakai plasmid pO157</span></span>
<span class="line"><span>  NC_002127.1    3306       Escherichia coli O157:H7 str. Sakai plasmid pOSAK1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>sed 命令删除逗号后的文本（例如，完整基因组、完整序列、主要组装）。</p><p>类似的查询用于人类，同时过滤掉支架、重叠群和质粒：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  esearch -db assembly -query &quot;Homo sapiens [ORGN] AND representative [PROP]&quot; |</span></span>
<span class="line"><span>  elink -target nuccore -name assembly_nuccore_refseq |</span></span>
<span class="line"><span>  efetch -format docsum |</span></span>
<span class="line"><span>  xtract -pattern DocumentSummary -element AccessionVersion Slen Title |</span></span>
<span class="line"><span>  sed &#39;s/,.*//&#39; |</span></span>
<span class="line"><span>  grep -v scaffold | grep -v contig | grep -v plasmid | grep -v patch |</span></span>
<span class="line"><span>  sort</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>返回已组装的染色体和线粒体序列记录：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  NC_000001.11    248956422    Homo sapiens chromosome 1</span></span>
<span class="line"><span>  NC_000002.12    242193529    Homo sapiens chromosome 2</span></span>
<span class="line"><span>  NC_000003.12    198295559    Homo sapiens chromosome 3</span></span>
<span class="line"><span>  NC_000004.12    190214555    Homo sapiens chromosome 4</span></span>
<span class="line"><span>  NC_000005.10    181538259    Homo sapiens chromosome 5</span></span>
<span class="line"><span>  NC_000006.12    170805979    Homo sapiens chromosome 6</span></span>
<span class="line"><span>  NC_000007.14    159345973    Homo sapiens chromosome 7</span></span>
<span class="line"><span>  NC_000008.11    145138636    Homo sapiens chromosome 8</span></span>
<span class="line"><span>  NC_000009.12    138394717    Homo sapiens chromosome 9</span></span>
<span class="line"><span>  NC_000010.11    133797422    Homo sapiens chromosome 10</span></span>
<span class="line"><span>  NC_000011.10    135086622    Homo sapiens chromosome 11</span></span>
<span class="line"><span>  NC_000012.12    133275309    Homo sapiens chromosome 12</span></span>
<span class="line"><span>  NC_000013.11    114364328    Homo sapiens chromosome 13</span></span>
<span class="line"><span>  NC_000014.9     107043718    Homo sapiens chromosome 14</span></span>
<span class="line"><span>  NC_000015.10    101991189    Homo sapiens chromosome 15</span></span>
<span class="line"><span>  NC_000016.10    90338345     Homo sapiens chromosome 16</span></span>
<span class="line"><span>  NC_000017.11    83257441     Homo sapiens chromosome 17</span></span>
<span class="line"><span>  NC_000018.10    80373285     Homo sapiens chromosome 18</span></span>
<span class="line"><span>  NC_000019.10    58617616     Homo sapiens chromosome 19</span></span>
<span class="line"><span>  NC_000020.11    64444167     Homo sapiens chromosome 20</span></span>
<span class="line"><span>  NC_000021.9     46709983     Homo sapiens chromosome 21</span></span>
<span class="line"><span>  NC_000022.11    50818468     Homo sapiens chromosome 22</span></span>
<span class="line"><span>  NC_000023.11    156040895    Homo sapiens chromosome X</span></span>
<span class="line"><span>  NC_000024.10    57227415     Homo sapiens chromosome Y</span></span>
<span class="line"><span>  NC_012920.1     16569        Homo sapiens mitochondrion</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="该过程可以自动化-以循环遍历指定的生物体列表" tabindex="-1"><a class="header-anchor" href="#该过程可以自动化-以循环遍历指定的生物体列表"><span>该过程可以自动化，以循环遍历指定的生物体列表：</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  for org in \</span></span>
<span class="line"><span>    &quot;Agrobacterium tumefaciens&quot; \</span></span>
<span class="line"><span>    &quot;Bacillus anthracis&quot; \</span></span>
<span class="line"><span>    &quot;Escherichia coli&quot; \</span></span>
<span class="line"><span>    &quot;Neisseria gonorrhoeae&quot; \</span></span>
<span class="line"><span>    &quot;Pseudomonas aeruginosa&quot; \</span></span>
<span class="line"><span>    &quot;Shigella flexneri&quot; \</span></span>
<span class="line"><span>    &quot;Streptococcus pneumoniae&quot;</span></span>
<span class="line"><span>  do</span></span>
<span class="line"><span>    esearch -db assembly -query &quot;$org [ORGN]&quot; |</span></span>
<span class="line"><span>    efilter -query &quot;representative [PROP]&quot; |</span></span>
<span class="line"><span>    elink -target nuccore -name assembly_nuccore_refseq |</span></span>
<span class="line"><span>    efetch -format docsum |</span></span>
<span class="line"><span>    xtract -pattern DocumentSummary -element AccessionVersion Slen Title |</span></span>
<span class="line"><span>    sed &#39;s/,.*//&#39; |</span></span>
<span class="line"><span>    grep -v -i -e scaffold -e contig -e plasmid -e sequence -e patch |</span></span>
<span class="line"><span>    sort-table -k 2,2nr</span></span>
<span class="line"><span>  done</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这将生成：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  NC_011985.1    4005130    Agrobacterium radiobacter K84 chromosome 1</span></span>
<span class="line"><span>  NC_011983.1    2650913    Agrobacterium radiobacter K84 chromosome 2</span></span>
<span class="line"><span>  NC_005945.1    5228663    Bacillus anthracis str. Sterne chromosome</span></span>
<span class="line"><span>  NC_003997.3    5227293    Bacillus anthracis str. Ames chromosome</span></span>
<span class="line"><span>  NC_002695.1    5498450    Escherichia coli O157:H7 str. Sakai chromosome</span></span>
<span class="line"><span>  NC_018658.1    5273097    Escherichia coli O104:H4 str. 2011C-3493 ...</span></span>
<span class="line"><span>  NC_011751.1    5202090    Escherichia coli UMN026 chromosome</span></span>
<span class="line"><span>  NC_011750.1    5132068    Escherichia coli IAI39 chromosome</span></span>
<span class="line"><span>  NC_017634.1    4747819    Escherichia coli O83:H1 str. NRG 857C chromosome</span></span>
<span class="line"><span>  NC_000913.3    4641652    Escherichia coli str. K-12 substr. MG1655</span></span>
<span class="line"><span>  NC_002946.2    2153922    Neisseria gonorrhoeae FA 1090 chromosome</span></span>
<span class="line"><span>  NC_002516.2    6264404    Pseudomonas aeruginosa PAO1 chromosome</span></span>
<span class="line"><span>  NC_004337.2    4607202    Shigella flexneri 2a str. 301 chromosome</span></span>
<span class="line"><span>  NC_003028.3    2160842    Streptococcus pneumoniae TIGR4 chromosome</span></span>
<span class="line"><span>  NC_003098.1    2038615    Streptococcus pneumoniae R6 chromosome</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="snp" tabindex="-1"><a class="header-anchor" href="#snp"><span>SNP</span></a></h2><h3 id="snp-数据表" tabindex="-1"><a class="header-anchor" href="#snp-数据表"><span>SNP 数据表</span></a></h3><p>如何从文档摘要中获取 SNP 属性的制表符分隔表？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  efetch -db snp -id 11549407 -format docsum |</span></span>
<span class="line"><span>  snp2tbl</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>snp2tbl</strong> 脚本从 HGVS 数据中提取字段并打印各个值以供进一步处理：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  rs11549407    NC_000011.10    5226773    G    A    Genomic    Substitution    HBB</span></span>
<span class="line"><span>  rs11549407    NC_000011.10    5226773    G    C    Genomic    Substitution    HBB</span></span>
<span class="line"><span>  rs11549407    NC_000011.10    5226773    G    T    Genomic    Substitution    HBB</span></span>
<span class="line"><span>  rs11549407    NG_000007.3     70841      C    A    Genomic    Substitution    HBB</span></span>
<span class="line"><span>  rs11549407    NG_000007.3     70841      C    G    Genomic    Substitution    HBB</span></span>
<span class="line"><span>  rs11549407    NG_000007.3     70841      C    T    Genomic    Substitution    HBB</span></span>
<span class="line"><span>  ... </span></span>
<span class="line"><span>  rs11549407    NM_000518.5     167        C    A    Coding     Substitution    HBB</span></span>
<span class="line"><span>  rs11549407    NM_000518.5     167        C    G    Coding     Substitution    HBB</span></span>
<span class="line"><span>  rs11549407    NM_000518.5     167        C    T    Coding     Substitution    HBB</span></span>
<span class="line"><span>  rs11549407    NP_000509.1     39         Q    *    Protein    Termination     HBB</span></span>
<span class="line"><span>  rs11549407    NP_000509.1     39         Q    E    Protein    Missense        HBB</span></span>
<span class="line"><span>  rs11549407    NP_000509.1     39         Q    K    Protein    Missense        HBB</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>列为 SNP 标识符、登录号、版本、序列起始偏移量、删除的字母、插入的字母、序列类别、变异类型和基因名称。内部步骤（<strong>snp2hgvs</strong>、<strong>hgvs2spdi</strong> 和 <strong>spdi2tbl</strong>）如下所述。</p><h3 id="氨基酸取代" tabindex="-1"><a class="header-anchor" href="#氨基酸取代"><span>氨基酸取代</span></a></h3><p>绿敏感视蛋白的错义产物是什么？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  esearch -db gene -query &quot;OPN1MW [PREF] AND human [ORGN]&quot; |</span></span>
<span class="line"><span>  elink -target snp | efilter -class missense |</span></span>
<span class="line"><span>  efetch -format docsum |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>SNP 文档摘要包含以下形式的 HGVS 数据：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  NC_000023.11:g.154193517C&gt;A, ... ,NP_000504.1:p.Ala285Val</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>可以通过 xtract <strong>‑hgvs</strong> 命令在 <strong>snp2hgvs</strong> 脚本中解析为：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  snp2hgvs |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>将核苷酸和氨基酸替换的结构化表示：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  ...</span></span>
<span class="line"><span>  &lt;HGVS&gt;</span></span>
<span class="line"><span>    &lt;Id&gt;782327292&lt;/Id&gt;</span></span>
<span class="line"><span>    &lt;Gene&gt;OPN1MW&lt;/Gene&gt;</span></span>
<span class="line"><span>    &lt;Variant&gt;</span></span>
<span class="line"><span>      &lt;Class&gt;Genomic&lt;/Class&gt;</span></span>
<span class="line"><span>      &lt;Type&gt;Substitution&lt;/Type&gt;</span></span>
<span class="line"><span>      &lt;Accession&gt;NC_000023.11&lt;/Accession&gt;</span></span>
<span class="line"><span>      &lt;Position&gt;154193516&lt;/Position&gt;</span></span>
<span class="line"><span>      &lt;Deleted&gt;C&lt;/Deleted&gt;</span></span>
<span class="line"><span>      &lt;Inserted&gt;A&lt;/Inserted&gt;</span></span>
<span class="line"><span>      &lt;Hgvs&gt;NC_000023.11:g.154193517C&amp;gt;A&lt;/Hgvs&gt;</span></span>
<span class="line"><span>    &lt;/Variant&gt;</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>    &lt;Variant&gt;</span></span>
<span class="line"><span>      &lt;Class&gt;Coding&lt;/Class&gt;</span></span>
<span class="line"><span>      &lt;Type&gt;Substitution&lt;/Type&gt;</span></span>
<span class="line"><span>      &lt;Accession&gt;NM_000513.2&lt;/Accession&gt;</span></span>
<span class="line"><span>      &lt;Offset&gt;853&lt;/Offset&gt;</span></span>
<span class="line"><span>      &lt;Deleted&gt;C&lt;/Deleted&gt;</span></span>
<span class="line"><span>      &lt;Inserted&gt;T&lt;/Inserted&gt;</span></span>
<span class="line"><span>      &lt;Hgvs&gt;NM_000513.2:c.854C&amp;gt;T&lt;/Hgvs&gt;</span></span>
<span class="line"><span>    &lt;/Variant&gt;</span></span>
<span class="line"><span>    &lt;Variant&gt;</span></span>
<span class="line"><span>      &lt;Class&gt;Protein&lt;/Class&gt;</span></span>
<span class="line"><span>      &lt;Type&gt;Missense&lt;/Type&gt;</span></span>
<span class="line"><span>      &lt;Accession&gt;NP_000504.1&lt;/Accession&gt;</span></span>
<span class="line"><span>      &lt;Position&gt;284&lt;/Position&gt;</span></span>
<span class="line"><span>      &lt;Deleted&gt;A&lt;/Deleted&gt;</span></span>
<span class="line"><span>      &lt;Inserted&gt;D&lt;/Inserted&gt;</span></span>
<span class="line"><span>      &lt;Hgvs&gt;NP_000504.1:p.Ala285Asp&lt;/Hgvs&gt;</span></span>
<span class="line"><span>    &lt;/Variant&gt;</span></span>
<span class="line"><span>    &lt;Variant&gt;</span></span>
<span class="line"><span>      &lt;Class&gt;Protein&lt;/Class&gt;</span></span>
<span class="line"><span>      &lt;Type&gt;Missense&lt;/Type&gt;</span></span>
<span class="line"><span>      &lt;Accession&gt;NP_000504.1&lt;/Accession&gt;</span></span>
<span class="line"><span>      &lt;Position&gt;284&lt;/Position&gt;</span></span>
<span class="line"><span>      &lt;Deleted&gt;A&lt;/Deleted&gt;</span></span>
<span class="line"><span>      &lt;Inserted&gt;V&lt;/Inserted&gt;</span></span>
<span class="line"><span>      &lt;Hgvs&gt;NP_000504.1:p.Ala285Val&lt;/Hgvs&gt;</span></span>
<span class="line"><span>    &lt;/Variant&gt;</span></span>
<span class="line"><span>  &lt;/HGVS&gt;</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>原始的 1 基准 HGVS 位置在 XML 中转换为 0 基准。</p><p>将这些结果传递通过 <strong>hgvs2spdi</strong> 脚本：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  hgvs2spdi |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>将 CDS 相对偏移量转换为序列相对位置：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  ...</span></span>
<span class="line"><span>  &lt;SPDI&gt;</span></span>
<span class="line"><span>    &lt;Id&gt;782327292&lt;/Id&gt;</span></span>
<span class="line"><span>    &lt;Gene&gt;OPN1MW&lt;/Gene&gt;</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>    &lt;Variant&gt;</span></span>
<span class="line"><span>      &lt;Class&gt;Coding&lt;/Class&gt;</span></span>
<span class="line"><span>      &lt;Type&gt;Substitution&lt;/Type&gt;</span></span>
<span class="line"><span>      &lt;Accession&gt;NM_000513.2&lt;/Accession&gt;</span></span>
<span class="line"><span>      &lt;Position&gt;935&lt;/Position&gt;</span></span>
<span class="line"><span>      &lt;Offset&gt;853&lt;/Offset&gt;</span></span>
<span class="line"><span>      &lt;Deleted&gt;C&lt;/Deleted&gt;</span></span>
<span class="line"><span>      &lt;Inserted&gt;A&lt;/Inserted&gt;</span></span>
<span class="line"><span>      &lt;Hgvs&gt;NM_000513.2:c.854C&amp;gt;A&lt;/Hgvs&gt;</span></span>
<span class="line"><span>      &lt;Spdi&gt;NM_000513.2:935:C:A&lt;/Spdi&gt;</span></span>
<span class="line"><span>    &lt;/Variant&gt;</span></span>
<span class="line"><span>    &lt;Variant&gt;</span></span>
<span class="line"><span>      &lt;Class&gt;Coding&lt;/Class&gt;</span></span>
<span class="line"><span>      &lt;Type&gt;Substitution&lt;/Type&gt;</span></span>
<span class="line"><span>      &lt;Accession&gt;NM_000513.2&lt;/Accession&gt;</span></span>
<span class="line"><span>      &lt;Position&gt;935&lt;/Position&gt;</span></span>
<span class="line"><span>      &lt;Offset&gt;853&lt;/Offset&gt;</span></span>
<span class="line"><span>      &lt;Deleted&gt;C&lt;/Deleted&gt;</span></span>
<span class="line"><span>      &lt;Inserted&gt;T&lt;/Inserted&gt;</span></span>
<span class="line"><span>      &lt;Hgvs&gt;NM_000513.2:c.854C&amp;gt;T&lt;/Hgvs&gt;</span></span>
<span class="line"><span>      &lt;Spdi&gt;NM_000513.2:935:C:T&lt;/Spdi&gt;</span></span>
<span class="line"><span>    &lt;/Variant&gt;</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>  &lt;/SPDI&gt;</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>将这些数据通过 <strong>spdi2tbl</strong> 脚本处理：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  spdi2tbl |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>完成 <strong>snp2tbl</strong> 流程的最后一步，生成一个 SNP 数据表。通过以下命令进行过滤：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  grep Protein | grep Missense | cut -f 1-5</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>得到按登录号、位置和残基排序的氨基酸替换表：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  rs1238141906    NP_000504.1    40    E    K</span></span>
<span class="line"><span>  rs1189783086    NP_000504.1    42    P    L</span></span>
<span class="line"><span>  rs1257135801    NP_000504.1    45    H    Y</span></span>
<span class="line"><span>  rs1284438666    NP_000504.1    63    V    I</span></span>
<span class="line"><span>  rs1223726997    NP_000504.1    64    I    T</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这些行在一个 while 循环中处理，缓存当前序列数据：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  while read rsid accn ofs del ins</span></span>
<span class="line"><span>  do</span></span>
<span class="line"><span>    if [ &quot;$accn&quot; != &quot;$last&quot; ]</span></span>
<span class="line"><span>    then</span></span>
<span class="line"><span>      seq=$( efetch -db protein -id &quot;$accn&quot; -format gpc &lt; /dev/null |</span></span>
<span class="line"><span>             xtract -pattern INSDSeq -lower INSDSeq_sequence )</span></span>
<span class="line"><span>      last=&quot;$accn&quot;</span></span>
<span class="line"><span>    fi</span></span>
<span class="line"><span>    pos=$((ofs + 1))</span></span>
<span class="line"><span>    echo &quot;&gt;$rsid [$accn $ins@$pos]&quot;</span></span>
<span class="line"><span>    echo &quot;$seq&quot; |</span></span>
<span class="line"><span>    transmute -replace -offset &quot;$ofs&quot; -delete &quot;$del&quot; -insert &quot;$ins&quot; -lower |</span></span>
<span class="line"><span>    fold -w 50</span></span>
<span class="line"><span>  done</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>并使用 transmute <strong>‑replace</strong> 生成在替换残基处以大写形式显示的修改后的 FASTA 文件：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  &gt;rs1238141906 [NP_000504.1 K@41]</span></span>
<span class="line"><span>  maqqwslqrlagrhpqdsyedstqssiftytnsnstrgpfKgpnyhiapr</span></span>
<span class="line"><span>  wvyhltsvwmifvviasvftnglvlaatmkfkklrhplnwilvnlavadl</span></span>
<span class="line"><span>  aetviastisvvnqvygyfvlghpmcvlegytvslcgitglwslaiiswe</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="snp-修饰产物对" tabindex="-1"><a class="header-anchor" href="#snp-修饰产物对"><span>SNP 修饰产物对</span></a></h3><p>如何匹配密码子修改和氨基酸替换？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  efetch -db snp -id 11549407 -format docsum |</span></span>
<span class="line"><span>  snp2tbl |</span></span>
<span class="line"><span>  tbl2prod</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>对于在同一位置具有不同替换的 SNP，<strong>tbl2prod</strong> 脚本翻译编码序列（在核苷酸修改后），并与蛋白质序列（在残基替换后）排序，生成相邻匹配的 CDS/蛋白质对：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  rs11549407    NM_000518.5:167:C:T    MVHLTPEEKSAVTALWGKVNVDEVGGEALGRLLVVYPWT*R...</span></span>
<span class="line"><span>  rs11549407    NP_000509.1:39:Q:*     MVHLTPEEKSAVTALWGKVNVDEVGGEALGRLLVVYPWT*R...</span></span>
<span class="line"><span>  rs11549407    NM_000518.5:167:C:G    MVHLTPEEKSAVTALWGKVNVDEVGGEALGRLLVVYPWTER...</span></span>
<span class="line"><span>  rs11549407    NP_000509.1:39:Q:E     MVHLTPEEKSAVTALWGKVNVDEVGGEALGRLLVVYPWTER...</span></span>
<span class="line"><span>  rs11549407    NM_000518.5:167:C:A    MVHLTPEEKSAVTALWGKVNVDEVGGEALGRLLVVYPWTKR...</span></span>
<span class="line"><span>  rs11549407    NP_000509.1:39:Q:K     MVHLTPEEKSAVTALWGKVNVDEVGGEALGRLLVVYPWTKR...</span></span>
<span class="line"><span>  rs11549407    NM_000518.5:167:C:+    MVHLTPEEKSAVTALWGKVNVDEVGGEALGRLLVVYPWTQR...</span></span>
<span class="line"><span>  rs11549407    NP_000509.1:39:Q:+     MVHLTPEEKSAVTALWGKVNVDEVGGEALGRLLVVYPWTQR...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>“<strong>+</strong>” 号表示未修改的“野生型”核苷酸或氨基酸。</p><h2 id="结构" tabindex="-1"><a class="header-anchor" href="#结构"><span>结构</span></a></h2><h3 id="结构相似性" tabindex="-1"><a class="header-anchor" href="#结构相似性"><span>结构相似性</span></a></h3><p>哪些古菌结构与蛇毒磷脂酶相似？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  esearch -db structure -query &quot;crotalus [ORGN] AND phospholipase A2&quot; |</span></span>
<span class="line"><span>  elink -related |</span></span>
<span class="line"><span>  efilter -query &quot;archaea [ORGN]&quot; |</span></span>
<span class="line"><span>  efetch -format docsum |</span></span>
<span class="line"><span>  xtract -pattern DocumentSummary \</span></span>
<span class="line"><span>    -if PdbClass -equals Hydrolase \</span></span>
<span class="line"><span>      -element PdbDescr |</span></span>
<span class="line"><span>  sort -f | uniq -i</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结构邻居使用几何比较找到蛋白质，这些蛋白质与通过 BLAST 搜索找到的序列相似性不同：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  Crystal Structure Of Autoprocessed Form Of Tk-Subtilisin</span></span>
<span class="line"><span>  Crystal Structure Of Ca2 Site Mutant Of Pro-S324a</span></span>
<span class="line"><span>  Crystal Structure Of Ca3 Site Mutant Of Pro-S324a</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="分类" tabindex="-1"><a class="header-anchor" href="#分类"><span>分类</span></a></h2><h3 id="分类谱系" tabindex="-1"><a class="header-anchor" href="#分类谱系"><span>分类谱系</span></a></h3><p>人类的主要分类谱系节点是什么？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  efetch -db taxonomy -id 9606 -format xml |</span></span>
<span class="line"><span>  xtract -pattern Taxon -first TaxId -tab &quot;\n&quot; -element ScientificName \</span></span>
<span class="line"><span>    -block &quot;**/Taxon&quot; \</span></span>
<span class="line"><span>      -if Rank -is-not &quot;no rank&quot; -and Rank -is-not clade \</span></span>
<span class="line"><span>        -tab &quot;\n&quot; -element Rank,ScientificName</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这使用双星/子级结构递归地探索数据层次结构：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  9606            Homo sapiens</span></span>
<span class="line"><span>  superkingdom    Eukaryota</span></span>
<span class="line"><span>  kingdom         Metazoa</span></span>
<span class="line"><span>  phylum          Chordata</span></span>
<span class="line"><span>  subphylum       Craniata</span></span>
<span class="line"><span>  superclass      Sarcopterygii</span></span>
<span class="line"><span>  class           Mammalia</span></span>
<span class="line"><span>  superorder      Euarchontoglires</span></span>
<span class="line"><span>  order           Primates</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="分类搜索" tabindex="-1"><a class="header-anchor" href="#分类搜索"><span>分类搜索</span></a></h3><p>哪些生物体包含注释的 RefSeq 基因组 MatK 基因？</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  esearch -db nuccore -query &quot;MatK [GENE] AND NC_0:NC_999999999 [PACC]&quot; |</span></span>
<span class="line"><span>  efetch -format docsum |</span></span>
<span class="line"><span>  xtract -pattern DocumentSummary -element TaxId |</span></span>
<span class="line"><span>  sort -n | uniq |</span></span>
<span class="line"><span>  epost -db taxonomy |</span></span>
<span class="line"><span>  efetch -format docsum |</span></span>
<span class="line"><span>  xtract -pattern DocumentSummary -element ScientificName |</span></span>
<span class="line"><span>  sort</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>第一个查询从核苷酸文档摘要中获取分类 UID，并将其上传以便从分类数据库中单独检索：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  Acidosasa purpurea</span></span>
<span class="line"><span>  Acorus americanus</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  Zingiber spectabile</span></span>
<span class="line"><span>  Zygnema circumcarinatum</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="生物样本" tabindex="-1"><a class="header-anchor" href="#生物样本"><span>生物样本</span></a></h2><p>生物样本文档摘要：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  esummary -db biosample -id SAMN34375013 |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>使用 XML 属性来识别数据元素类型：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  &lt;Attribute attribute_name=&quot;strain&quot; harmonized_name=&quot;strain&quot; ...&gt;KF24&lt;/Attribute&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>一个两阶段 xtract 管道可以生成制表符分隔的表格，每列对应一个选定字段。将数据传输到第一个命令：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  xtract -rec BioSampleInfo -pattern DocumentSummary \</span></span>
<span class="line"><span>    -wrp Accession -element Accession \</span></span>
<span class="line"><span>    -wrp Title -element DocumentSummary/Title \</span></span>
<span class="line"><span>    -wrp Link -sep &quot;|&quot; -numeric Links/Link \</span></span>
<span class="line"><span>    -group Attribute -if @harmonized_name \</span></span>
<span class="line"><span>      -TAG -lower @harmonized_name -wrp &quot;&amp;TAG&quot; -element Attribute |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>生成一个中间形式，使用来自 &quot;harmonized_name&quot; 属性的 XML 对象名称：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  &lt;BioSampleInfo&gt;</span></span>
<span class="line"><span>    &lt;Accession&gt;SAMN34375013&lt;/Accession&gt;</span></span>
<span class="line"><span>    &lt;Title&gt;Microbe sample from Bacillus subtilis&lt;/Title&gt;</span></span>
<span class="line"><span>    &lt;Link&gt;960711&lt;/Link&gt;</span></span>
<span class="line"><span>    &lt;isolation_source&gt;rhizosphere soil&lt;/isolation_source&gt;</span></span>
<span class="line"><span>    &lt;collection_date&gt;missing&lt;/collection_date&gt;</span></span>
<span class="line"><span>    &lt;geo_loc_name&gt;China: Kaifeng, Henan Province&lt;/geo_loc_name&gt;</span></span>
<span class="line"><span>    &lt;sample_type&gt;bacterial isolate&lt;/sample_type&gt;</span></span>
<span class="line"><span>    &lt;lat_lon&gt;34.14 N 114.05 E&lt;/lat_lon&gt;</span></span>
<span class="line"><span>    &lt;strain&gt;KF24&lt;/strain&gt;</span></span>
<span class="line"><span>  &lt;/BioSampleInfo&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（一个包含此第一个 xtract 命令的 <strong>bsmp2info</strong> 脚本现已包含在 EDirect 中。）</p><p>然后可以在第二个 xtract 命令的最后一行中按名称选择所需字段，对于任何缺失值打印一个 &quot;-&quot; 占位符：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  xtract -pattern BioSampleInfo -def &quot;-&quot; -first Accession Title Link \</span></span>
<span class="line"><span>    geo_loc_name isolation_source strain lat_lon</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 ‑first 而不是 ‑element 消除了在属性名称从 &quot;country&quot; 转变为 &quot;geo_loc_name&quot; 期间可能出现的重复条目。</p><h2 id="sra" tabindex="-1"><a class="header-anchor" href="#sra"><span>SRA</span></a></h2><h3 id="使用-runinfo-格式" tabindex="-1"><a class="header-anchor" href="#使用-runinfo-格式"><span>使用 RunInfo 格式</span></a></h3><p>SRA 数据可以以 RunInfo 格式检索：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  efetch -db sra -id SRR6314034 -format runinfo |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>以逗号分隔的值，第一行包含字段名称：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  Run,ReleaseDate,LoadDate,spots,bases,spots_with_mates,avgLength,...</span></span>
<span class="line"><span>  SRR6314034,2017-11-21 23:27:11,2017-11-21 23:25:38,128,539118,0,...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>通过 <strong>csv2xml</strong> 脚本，并使用 ‑header 标志：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  csv2xml -set Set -rec Rec -header |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>将数据转换为 XML：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  &lt;Set&gt;</span></span>
<span class="line"><span>    &lt;Rec&gt;</span></span>
<span class="line"><span>      &lt;Run&gt;SRR6314034&lt;/Run&gt;</span></span>
<span class="line"><span>      &lt;ReleaseDate&gt;2017-11-21 23:27:11&lt;/ReleaseDate&gt;</span></span>
<span class="line"><span>      &lt;LoadDate&gt;2017-11-21 23:25:38&lt;/LoadDate&gt;</span></span>
<span class="line"><span>      &lt;spots&gt;128&lt;/spots&gt;</span></span>
<span class="line"><span>      &lt;bases&gt;539118&lt;/bases&gt;</span></span>
<span class="line"><span>      &lt;spots_with_mates&gt;0&lt;/spots_with_mates&gt;</span></span>
<span class="line"><span>      &lt;avgLength&gt;4211&lt;/avgLength&gt;</span></span>
<span class="line"><span>      &lt;size_MB&gt;0&lt;/size_MB&gt;</span></span>
<span class="line"><span>      &lt;AssemblyName&gt;&lt;/AssemblyName&gt;</span></span>
<span class="line"><span>      &lt;download_path&gt;...&lt;/download_path&gt;</span></span>
<span class="line"><span>      &lt;Experiment&gt;SRX3413965&lt;/Experiment&gt;</span></span>
<span class="line"><span>      &lt;LibraryName&gt;child&lt;/LibraryName&gt;</span></span>
<span class="line"><span>      &lt;LibraryStrategy&gt;AMPLICON&lt;/LibraryStrategy&gt;</span></span>
<span class="line"><span>      &lt;LibrarySelection&gt;PCR&lt;/LibrarySelection&gt;</span></span>
<span class="line"><span>      &lt;LibrarySource&gt;GENOMIC&lt;/LibrarySource&gt;</span></span>
<span class="line"><span>      &lt;LibraryLayout&gt;SINGLE&lt;/LibraryLayout&gt;</span></span>
<span class="line"><span>      &lt;InsertSize&gt;0&lt;/InsertSize&gt;</span></span>
<span class="line"><span>      &lt;InsertDev&gt;0&lt;/InsertDev&gt;</span></span>
<span class="line"><span>      &lt;Platform&gt;PACBIO_SMRT&lt;/Platform&gt;</span></span>
<span class="line"><span>      &lt;Model&gt;PacBio RS II&lt;/Model&gt;</span></span>
<span class="line"><span>      &lt;SRAStudy&gt;SRP125431&lt;/SRAStudy&gt;</span></span>
<span class="line"><span>      &lt;BioProject&gt;PRJNA418990&lt;/BioProject&gt;</span></span>
<span class="line"><span>      &lt;Study_Pubmed_id&gt;&lt;/Study_Pubmed_id&gt;</span></span>
<span class="line"><span>      &lt;ProjectID&gt;418990&lt;/ProjectID&gt;</span></span>
<span class="line"><span>      &lt;Sample&gt;SRS2707133&lt;/Sample&gt;</span></span>
<span class="line"><span>      &lt;BioSample&gt;SAMN08040264&lt;/BioSample&gt;</span></span>
<span class="line"><span>      &lt;SampleType&gt;simple&lt;/SampleType&gt;</span></span>
<span class="line"><span>      &lt;TaxID&gt;9606&lt;/TaxID&gt;</span></span>
<span class="line"><span>      &lt;ScientificName&gt;Homo sapiens&lt;/ScientificName&gt;</span></span>
<span class="line"><span>      &lt;SampleName&gt;BBS9_del_mother&lt;/SampleName&gt;</span></span>
<span class="line"><span>      &lt;g1k_pop_code&gt;&lt;/g1k_pop_code&gt;</span></span>
<span class="line"><span>      &lt;source&gt;&lt;/source&gt;</span></span>
<span class="line"><span>      &lt;g1k_analysis_group&gt;&lt;/g1k_analysis_group&gt;</span></span>
<span class="line"><span>      &lt;Subject_ID&gt;&lt;/Subject_ID&gt;</span></span>
<span class="line"><span>      &lt;Sex&gt;female&lt;/Sex&gt;</span></span>
<span class="line"><span>      &lt;Disease&gt;&lt;/Disease&gt;</span></span>
<span class="line"><span>      &lt;Tumor&gt;no&lt;/Tumor&gt;</span></span>
<span class="line"><span>      &lt;Affection_Status&gt;&lt;/Affection_Status&gt;</span></span>
<span class="line"><span>      &lt;Analyte_Type&gt;&lt;/Analyte_Type&gt;</span></span>
<span class="line"><span>      &lt;Histological_Type&gt;&lt;/Histological_Type&gt;</span></span>
<span class="line"><span>      &lt;Body_Site&gt;&lt;/Body_Site&gt;</span></span>
<span class="line"><span>      &lt;CenterName&gt;ICAHN SCHOOL OF MEDICINE AT MOUNT SINAI&lt;/CenterName&gt;</span></span>
<span class="line"><span>      &lt;Submission&gt;SRA633054&lt;/Submission&gt;</span></span>
<span class="line"><span>      &lt;dbgap_study_accession&gt;&lt;/dbgap_study_accession&gt;</span></span>
<span class="line"><span>      &lt;Consent&gt;public&lt;/Consent&gt;</span></span>
<span class="line"><span>      &lt;RunHash&gt;19AC4EB8A65D733274756464DCCF65EA&lt;/RunHash&gt;</span></span>
<span class="line"><span>      &lt;ReadHash&gt;AC8F39C51F95D9CD1BD0CBFBB669AD1E&lt;/ReadHash&gt;</span></span>
<span class="line"><span>    &lt;/Rec&gt;</span></span>
<span class="line"><span>  &lt;/Set&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后可以通过 xtract 管道：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  xtract -pattern Rec -def &quot;-&quot; -element Run Experiment BioProject BioSample</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>按字段名称检索所需的值：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  SRR6314034    SRX3413965    PRJNA418990    SAMN08040264</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="在云上安装-edirect" tabindex="-1"><a class="header-anchor" href="#在云上安装-edirect"><span>在云上安装 EDirect</span></a></h3><p>要安装 EDirect 软件，打开终端窗口并执行以下命令：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  sh -c &quot;$(curl -fsSL https://ftp.ncbi.nlm.nih.gov/entrez/entrezdirect/install-edirect.sh)&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>在安装结束时，回答 &quot;y&quot; 让脚本运行 PATH 更新命令以编辑配置文件，以便在后续终端会话中可以运行 EDirect 程序。</p><p>安装完成后，运行：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  export PATH=${PATH}:${HOME}/edirect</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>为当前终端会话设置 PATH。</p><h3 id="下载-blast-软件" tabindex="-1"><a class="header-anchor" href="#下载-blast-软件"><span>下载 BLAST 软件</span></a></h3><p>获取 Magic-BLAST 软件（如果尚未安装）：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  download-ncbi-software magic-blast</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="准备染色体文件" tabindex="-1"><a class="header-anchor" href="#准备染色体文件"><span>准备染色体文件</span></a></h3><p>检索人类 7 号染色体的序列：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  efetch -db nuccore -id NC_000007 -format fasta -immediate &gt; NC_000007.fsa</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>以文档摘要格式下载人类 7 号染色体上的蛋白质编码基因，并将基因范围提取到制表符分隔的表格中：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  esearch -db gene -query &quot;Homo sapiens [ORGN] AND 7 [CHR]&quot; |</span></span>
<span class="line"><span>  efilter -status alive -type coding | efetch -format docsum |</span></span>
<span class="line"><span>  gene2range &quot;7&quot; &gt; NC_000007.gen</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="sra-基因分析" tabindex="-1"><a class="header-anchor" href="#sra-基因分析"><span>SRA 基因分析</span></a></h3><p>对 SRR6314034 与 7 号染色体运行 <strong>magicblast</strong> 搜索：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  magicblast -sra SRR6314034 -subject NC_000007.fsa -outfmt asn |</span></span>
<span class="line"><span>  asn2xml &gt; SRR6314034.xml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>将比对详情通过 <strong>blst2tkns</strong> 脚本：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  cat SRR6314034.xml |</span></span>
<span class="line"><span>  blst2tkns |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>标记比对部分：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  index          1</span></span>
<span class="line"><span>  score          6268</span></span>
<span class="line"><span>  start          33088037</span></span>
<span class="line"><span>  stop           33167397</span></span>
<span class="line"><span>  strand         plus</span></span>
<span class="line"><span>  match          12</span></span>
<span class="line"><span>  mismatch       1</span></span>
<span class="line"><span>  genomic-ins    1</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>将这些数据通过 <strong>split-at-intron</strong> 脚本处理：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  split-at-intron |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>检测大规模基因组插入：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  6268    1    plus    33088037..33091003,33163798..33167397</span></span>
<span class="line"><span>  4910    2    plus    33089462..33091003,33163799..33167397</span></span>
<span class="line"><span>  1814    3    plus    33164965..33167397</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过以下命令按最小分数进行过滤：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  filter-columns &#39;$1 &gt; 1000&#39; |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>然后 <strong>fuse-ranges</strong> 脚本将重叠的比对合并：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  fuse-ranges |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>成为最小的扩展区间集：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  plus     33088037    33091003    2967</span></span>
<span class="line"><span>  plus     33163798    33167398    3601</span></span>
<span class="line"><span>  plus     33272248    33272278    31</span></span>
<span class="line"><span>  plus     33394238    33394551    314</span></span>
<span class="line"><span>  minus    33088037    33091004    2968</span></span>
<span class="line"><span>  minus    33163798    33167398    3601</span></span>
<span class="line"><span>  minus    33255886    33256012    127</span></span>
<span class="line"><span>  minus    33394326    33394551    226</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>将每个区间通过 <strong>find-in-gene</strong> 脚本处理：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  while read std min max len</span></span>
<span class="line"><span>  do</span></span>
<span class="line"><span>    cat NC_000007.gen |</span></span>
<span class="line"><span>    find-in-gene &quot;$std&quot; &quot;$min&quot; &quot;$max&quot;</span></span>
<span class="line"><span>  done |</span></span>
<span class="line"><span>  sort -f | uniq -i</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>返回重叠比对片段的基因名称：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  BBS9</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="pubchem" tabindex="-1"><a class="header-anchor" href="#pubchem"><span>PubChem</span></a></h2><h3 id="pubchem-在-entrez-中" tabindex="-1"><a class="header-anchor" href="#pubchem-在-entrez-中"><span>PubChem 在 Entrez 中</span></a></h3><p>Entrez 可以根据化合物的完整同义词进行搜索：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  esearch -db pccompound -query &quot;catechol [CSYN]&quot; |</span></span>
<span class="line"><span>  efetch -format uid</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>返回少量密切匹配的化合物标识符（CIDs）：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  73160</span></span>
<span class="line"><span>  9064</span></span>
<span class="line"><span>  289</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>化合物的 Entrez 文档摘要：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  efetch -db pccompound -id 289 -format docsum |</span></span>
<span class="line"><span>  xtract -pattern DocumentSummary -element MolecularFormula IsomericSmiles</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>包含化合物的通用描述信息字段：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  C6H6O2    C1=CC=C(C(=C1)O)O</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="power-user-gateway-pug-rest-查询表单" tabindex="-1"><a class="header-anchor" href="#power-user-gateway-pug-rest-查询表单"><span>Power User Gateway (PUG) REST 查询表单</span></a></h3><p>PubChem 还支持用于更高级查询的 RESTful 服务。Nquire 提供了一个 ‑pugrest URL 快捷方式。搜索请求的基本形式是：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  nquire -pugrest [compound|substance|assay] [input] [operation] [output]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>搜索可以使用化合物名称：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  nquire -pugrest compound name catechol cids TXT</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>以获取最佳匹配的化合物标识符：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  289</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>可以使用 CID 作为输入键来获取标题和描述：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  nquire -pugrest compound cid 289 description XML</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>或检索更详细的记录：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  nquire -pugrest compound cid 289 record XML |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>包含规范或异构 SMILES 代码：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  xtract -pattern PC-InfoData \</span></span>
<span class="line"><span>    -if PC-Urn_label -equals SMILES -and PC-Urn_name -equals Isomeric \</span></span>
<span class="line"><span>      -element PC-InfoData_value_sval</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="pubchem-化学标识符" tabindex="-1"><a class="header-anchor" href="#pubchem-化学标识符"><span>PubChem 化学标识符</span></a></h3><p>某些标识符类型需要 POST 参数来编码特殊符号：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  nquire -pugrest compound smiles description XML \</span></span>
<span class="line"><span>    -smiles &quot;C1=CC=C(C(=C1)O)O&quot; |</span></span>
<span class="line"><span>  xtract -pattern InformationList -element Title Description</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>返回化学名称和描述：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  Catechol    Catechol is a benzenediol comprising...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>其他需要在单独参数中编码的标识符键类型如下所示：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  nquire -pugrest compound inchi synonyms TXT \</span></span>
<span class="line"><span>    -inchi &quot;1S/C6H6O2/c7-5-3-1-2-4-6(5)8/h1-4,7-8H&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  nquire -pugrest compound inchikey cids JSON \</span></span>
<span class="line"><span>    -inchikey &quot;YCIMNLLNPGFGHC-UHFFFAOYSA-N&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  nquire -pugrest compound/fastsubstructure/smarts/cids/XML \</span></span>
<span class="line"><span>    -smarts &quot;[#7]-[#6]-1=[#6]-[#6](C#C)=[#6](-[#6]-[#8])-[#6]=[#6]-1&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（Nquire ‑inchi 如果参数字符串中缺少 &quot;InChI=&quot; 前缀，将提供预期的 &quot;InChI=&quot; 前缀。）</p><h3 id="pug-rest-异步查询" tabindex="-1"><a class="header-anchor" href="#pug-rest-异步查询"><span>PUG-REST 异步查询</span></a></h3><p>一些 PUG-REST 查询计算量大，异步运行：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  nquire -pugrest compound/superstructure/cid/2244/XML |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>返回的 <code>&lt;ListKey&gt;</code> 令牌传递给 nquire ‑pugwait 命令，后者轮询服务器直到结果可用：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  nquire -pugwait</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>然后下载标识符并直接放入 ENTREZ_DIRECT 消息中：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  &lt;ENTREZ_DIRECT&gt;</span></span>
<span class="line"><span>    &lt;Db&gt;pccompound&lt;/Db&gt;</span></span>
<span class="line"><span>    &lt;Count&gt;3750&lt;/Count&gt;</span></span>
<span class="line"><span>    &lt;Id&gt;87&lt;/Id&gt;</span></span>
<span class="line"><span>    &lt;Id&gt;175&lt;/Id&gt;</span></span>
<span class="line"><span>    &lt;Id&gt;176&lt;/Id&gt;</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>    &lt;Id&gt;162400221&lt;/Id&gt;</span></span>
<span class="line"><span>    &lt;Id&gt;162416056&lt;/Id&gt;</span></span>
<span class="line"><span>    &lt;Id&gt;162417911&lt;/Id&gt;</span></span>
<span class="line"><span>  &lt;/ENTREZ_DIRECT&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 2020 年重新设计 EDirect 时添加了对这种形式的支持。</p><h2 id="文献计量学" tabindex="-1"><a class="header-anchor" href="#文献计量学"><span>文献计量学</span></a></h2><h3 id="倒序排列" tabindex="-1"><a class="header-anchor" href="#倒序排列"><span>倒序排列</span></a></h3><p>重新打包整个文档摘要并创建用于排序的一组键：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  esearch -db pubmed -query &quot;tn3 transposition immunity&quot; |</span></span>
<span class="line"><span>  efetch -format docsum |</span></span>
<span class="line"><span>  xtract -rec Rec -pattern DocumentSummary -INDX &quot;+&quot; \</span></span>
<span class="line"><span>    -group DocumentSummary -pkg SortKeys \</span></span>
<span class="line"><span>      -unit DocumentSummary -wrp INDX -element &quot;&amp;INDX&quot; \</span></span>
<span class="line"><span>      -unit PubDate -wrp YEAR -year PubDate \</span></span>
<span class="line"><span>      -unit PubDate -wrp DATE -date &quot;*&quot; \</span></span>
<span class="line"><span>      -unit Title -wrp TITL -lower Title \</span></span>
<span class="line"><span>      -unit Author -position first -wrp FAUT -lower Name \</span></span>
<span class="line"><span>      -unit Author -position last -wrp LAUT -lower Name \</span></span>
<span class="line"><span>      -unit Authors -wrp ANUM -num Author/Name \</span></span>
<span class="line"><span>      -unit DocumentSummary -wrp SIZE -len &quot;*&quot; \</span></span>
<span class="line"><span>    -group DocumentSummary -pkg DS -element &quot;*&quot; |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>生成一个中间结构，带有用于排序键的独立容器和原始 docsum：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  ...</span></span>
<span class="line"><span>  &lt;Rec&gt;</span></span>
<span class="line"><span>    &lt;SortKeys&gt;</span></span>
<span class="line"><span>      &lt;INDX&gt;5&lt;/INDX&gt;</span></span>
<span class="line"><span>      &lt;YEAR&gt;1989&lt;/YEAR&gt;</span></span>
<span class="line"><span>      &lt;DATE&gt;1989/04&lt;/DATE&gt;</span></span>
<span class="line"><span>      &lt;TITL&gt;nucleotide sequences required for tn3 transposition immunity.&lt;/TITL&gt;</span></span>
<span class="line"><span>      &lt;FAUT&gt;kans ja&lt;/FAUT&gt;</span></span>
<span class="line"><span>      &lt;LAUT&gt;casadaban mj&lt;/LAUT&gt;</span></span>
<span class="line"><span>      &lt;ANUM&gt;2&lt;/ANUM&gt;</span></span>
<span class="line"><span>      &lt;SIZE&gt;1695&lt;/SIZE&gt;</span></span>
<span class="line"><span>    &lt;/SortKeys&gt;</span></span>
<span class="line"><span>    &lt;DS&gt;</span></span>
<span class="line"><span>      &lt;DocumentSummary&gt;</span></span>
<span class="line"><span>        &lt;Id&gt;2539356&lt;/Id&gt;</span></span>
<span class="line"><span>        &lt;PubDate&gt;1989 Apr&lt;/PubDate&gt;</span></span>
<span class="line"><span>        &lt;Source&gt;J Bacteriol&lt;/Source&gt;</span></span>
<span class="line"><span>        ...</span></span>
<span class="line"><span>      &lt;/DocumentSummary&gt;</span></span>
<span class="line"><span>    &lt;/DS&gt;</span></span>
<span class="line"><span>  &lt;/Rec&gt;</span></span>
<span class="line"><span>  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这允许按从 ‑year 派生的新标签排序记录：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  xtract -rec Rec -pattern Rec -sort-rev SortKeys/YEAR |</span></span>
<span class="line"><span>  xtract -set DocumentSummarySet -pattern Rec \</span></span>
<span class="line"><span>    -group DS/DocumentSummary -element &quot;*&quot; |</span></span>
<span class="line"><span>  transmute -format -combine |</span></span>
<span class="line"><span>  xtract -pattern DocumentSummary -element Id PubDate</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>以按出版日期倒序展示记录：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  36257990    2022 Oct 18</span></span>
<span class="line"><span>  28096365    2017 Jan 31</span></span>
<span class="line"><span>  22624153    2012 Feb</span></span>
<span class="line"><span>  21729108    2011 Sep</span></span>
<span class="line"><span>  8595595     1996 Jan</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="计算唯一期刊数" tabindex="-1"><a class="header-anchor" href="#计算唯一期刊数"><span>计算唯一期刊数</span></a></h3><p>一些文献计量分析需要获取大量 PubMed 记录。一个这样的例子是计算在给定类别下发布论文的唯一期刊数量。</p><p>一个通用函数整合代码以执行查询并从 EDirect 本地 PubMed 存档中获取记录。xtract <strong>‑histogram</strong> 快捷方式充当 ‑element 命令，后跟内置的排序-唯一-计数。（当结果数量以百万计时，这可以节省大量时间。）行数给出了发布至少一篇满足查询条件的论文的期刊数量：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  CountUniqueJournals() {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    qry=&quot;$1&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # 计算匹配查询条件的论文的唯一期刊数</span></span>
<span class="line"><span>    phrase-search -db pubmed -query &quot;$qry&quot; | fetch-pubmed |</span></span>
<span class="line"><span>    xtract -pattern PubmedArticle -histogram Journal/ISOAbbreviation |</span></span>
<span class="line"><span>    wc -l | tr -d &#39; &#39;</span></span>
<span class="line"><span>  }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>遍历一系列年份，并使用查询中的过滤条件调用此函数：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  for year in {2016..2022}</span></span>
<span class="line"><span>  do</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # 查找仍使用非结构化日期的期刊百分比</span></span>
<span class="line"><span>    filt=&quot;medline date [PROP]&quot; </span></span>
<span class="line"><span>    base=&quot;journal article [PTYP] AND $year [YEAR]&quot; </span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # 发布带有过滤条件的论文的期刊子集</span></span>
<span class="line"><span>    subs=$( CountUniqueJournals &quot;$base AND $filt&quot; ) </span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # 选定出版类型中的唯一期刊数</span></span>
<span class="line"><span>    totl=$( CountUniqueJournals &quot;$base&quot; ) </span></span>
<span class="line"><span></span></span>
<span class="line"><span>    frac=&quot;-&quot;</span></span>
<span class="line"><span>    if [ &quot;$totl&quot; -gt 0 ] </span></span>
<span class="line"><span>    then</span></span>
<span class="line"><span>      # 计算（整数）百分比</span></span>
<span class="line"><span>      frac=$((subs * 100 / totl)) </span></span>
<span class="line"><span>    fi</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # 打印年份、期刊数和使用过滤条件的百分比</span></span>
<span class="line"><span>    printf &quot;$year\t$subs\t$totl\t$frac\n&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  done | align-columns -h 2 -g 4 -a r</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>返回年份、该年份带有过滤条件和总计的唯一期刊数，以及两者的百分比。在此示例中，最后一列显示了提供非结构化出版日期的期刊百分比稳步下降：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>  2016    1933    10362    18</span></span>
<span class="line"><span>  2017    1153    10473    11</span></span>
<span class="line"><span>  2018    1071    10321    10</span></span>
<span class="line"><span>  2019     980    10027     9</span></span>
<span class="line"><span>  2020     919    10579     8</span></span>
<span class="line"><span>  2021     950    10947     8</span></span>
<span class="line"><span>  2022     835    10600     7</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="https://www.ncbi.nlm.nih.gov/books/about/copyright/" target="_blank" rel="noopener noreferrer">版权声明</a></p><p>书架编号：NBK565821</p></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/WhyLIM/E-utilities_zh-CN/edit/main/src/E-utilities_zh-CN/07-Entrez Direct Examples_zh-CN.md" aria-label="在 GitHub 上编辑此页" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><!----></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: mli.bio@outlook.com">Mli-TB</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/E-utilities_zh-CN/E-utilities_zh-CN/06-E-utilities%20on%20the%20Unix%20Command%20Line_zh-CN.html" aria-label="Entrez Direct：在 Unix 命令行上使用 E-utilities"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->Entrez Direct：在 Unix 命令行上使用 E-utilities</div></a><!----></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">开发快乐 :D</div><div class="vp-copyright">Copyright © 2024 WhyLIM </div></footer></div><!--]--><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/E-utilities_zh-CN/assets/app-BSJRkk3t.js" defer></script>
  </body>
</html>
